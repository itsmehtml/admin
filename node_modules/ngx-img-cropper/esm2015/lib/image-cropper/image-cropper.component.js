import { __decorate, __metadata, __param } from "tslib";
import { Component, AfterViewInit, OnChanges, OnDestroy, ViewChild, ElementRef, Input, Output, EventEmitter, Renderer2, SimpleChanges, Inject } from '@angular/core';
import { CropperSettings } from './cropper-settings';
import { ImageCropper } from './imageCropper';
import { CropPosition } from './model/cropPosition';
import { Exif } from './exif';
import { DOCUMENT } from '@angular/common';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';

const _c0 = ["cropcanvas"];
const _c1 = ["fileInput"];
function ImageCropperComponent_input_1_Template(rf, ctx) { if (rf & 1) {
    const _r4 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "input", 4, 5);
    ɵngcc0.ɵɵlistener("change", function ImageCropperComponent_input_1_Template_input_change_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r4); const ctx_r3 = ɵngcc0.ɵɵnextContext(); return ctx_r3.fileChangeListener($event); });
    ɵngcc0.ɵɵelementEnd();
} }
let ImageCropperComponent = class ImageCropperComponent {
    constructor(renderer, document) {
        this.document = document;
        this.cropPositionChange = new EventEmitter();
        this.exif = new Exif();
        // tslint:disable-next-line:no-output-on-prefix
        this.onCrop = new EventEmitter();
        this.imageSet = new EventEmitter();
        this.dragUnsubscribers = [];
        this.renderer = renderer;
    }
    ngAfterViewInit() {
        const canvas = this.cropcanvas.nativeElement;
        if (!this.settings) {
            this.settings = new CropperSettings();
        }
        if (this.settings.cropperClass) {
            this.renderer.setAttribute(canvas, 'class', this.settings.cropperClass);
        }
        if (!this.settings.dynamicSizing) {
            this.renderer.setAttribute(canvas, 'width', this.settings.canvasWidth.toString());
            this.renderer.setAttribute(canvas, 'height', this.settings.canvasHeight.toString());
        }
        else {
            this.windowListener = this.resize.bind(this);
            window.addEventListener('resize', this.windowListener);
        }
        if (!this.cropper) {
            this.cropper = new ImageCropper(this.settings);
        }
        this.cropper.prepare(canvas);
    }
    ngOnChanges(changes) {
        if (this.isCropPositionChanged(changes)) {
            this.cropper.updateCropPosition(this.cropPosition.toBounds());
            if (this.cropper.isImageSet()) {
                const bounds = this.cropper.getCropBounds();
                this.image.image = this.cropper.getCroppedImageHelper().src;
                this.onCrop.emit(bounds);
            }
            this.updateCropBounds();
        }
        if (changes.inputImage) {
            this.setImage(changes.inputImage.currentValue);
        }
        if (changes.settings && this.cropper) {
            this.cropper.updateSettings(this.settings);
            if (this.cropper.isImageSet()) {
                this.image.image = this.cropper.getCroppedImageHelper().src;
                this.onCrop.emit(this.cropper.getCropBounds());
            }
        }
    }
    ngOnDestroy() {
        this.removeDragListeners();
        if (this.settings.dynamicSizing && this.windowListener) {
            window.removeEventListener('resize', this.windowListener);
        }
    }
    onTouchMove(event) {
        this.cropper.onTouchMove(event);
    }
    onTouchStart(event) {
        this.cropper.onTouchStart(event);
    }
    onTouchEnd(event) {
        this.cropper.onTouchEnd(event);
        if (this.cropper.isImageSet()) {
            this.image.image = this.cropper.getCroppedImageHelper().src;
            this.onCrop.emit(this.cropper.getCropBounds());
            this.updateCropBounds();
        }
    }
    onMouseDown(event) {
        this.dragUnsubscribers.push(this.renderer.listen(this.document, 'mousemove', this.onMouseMove.bind(this)));
        this.dragUnsubscribers.push(this.renderer.listen(this.document, 'mouseup', this.onMouseUp.bind(this)));
        this.cropper.onMouseDown(event);
        // if (!this.cropper.isImageSet() && !this.settings.noFileInput) {
        //   // load img
        //   this.fileInput.nativeElement.click();
        // }
    }
    removeDragListeners() {
        this.dragUnsubscribers.forEach(unsubscribe => unsubscribe());
    }
    onMouseUp(event) {
        this.removeDragListeners();
        if (this.cropper.isImageSet()) {
            this.cropper.onMouseUp(event);
            this.image.image = this.cropper.getCroppedImageHelper().src;
            this.onCrop.emit(this.cropper.getCropBounds());
            this.updateCropBounds();
        }
    }
    onMouseMove(event) {
        this.cropper.onMouseMove(event);
    }
    fileChangeListener($event) {
        if ($event.target.files.length === 0) {
            return;
        }
        const file = $event.target.files[0];
        if (this.settings.allowedFilesRegex.test(file.name)) {
            const image = new Image();
            const fileReader = new FileReader();
            fileReader.addEventListener('loadend', (loadEvent) => {
                image.addEventListener('load', () => {
                    this.setImage(image);
                });
                image.src = loadEvent.target.result;
            });
            fileReader.readAsDataURL(file);
        }
    }
    resize() {
        const canvas = this.cropcanvas.nativeElement;
        this.settings.canvasWidth = canvas.offsetWidth;
        this.settings.canvasHeight = canvas.offsetHeight;
        this.cropper.resizeCanvas(canvas.offsetWidth, canvas.offsetHeight, true);
    }
    reset() {
        this.cropper.reset();
        this.renderer.setAttribute(this.cropcanvas.nativeElement, 'class', this.settings.cropperClass);
        this.image.image = this.cropper.getCroppedImageHelper().src;
    }
    setImage(image, newBounds = null) {
        this.imageSet.emit(true);
        this.renderer.setAttribute(this.cropcanvas.nativeElement, 'class', `${this.settings.cropperClass} ${this.settings.croppingClass}`);
        this.raf = window.requestAnimationFrame(() => {
            if (this.raf) {
                window.cancelAnimationFrame(this.raf);
            }
            if (image.naturalHeight > 0 && image.naturalWidth > 0) {
                image.height = image.naturalHeight;
                image.width = image.naturalWidth;
                window.cancelAnimationFrame(this.raf);
                this.getOrientedImage(image, (img) => {
                    if (this.settings.dynamicSizing) {
                        const canvas = this.cropcanvas.nativeElement;
                        this.settings.canvasWidth = canvas.offsetWidth;
                        this.settings.canvasHeight = canvas.offsetHeight;
                        this.cropper.resizeCanvas(canvas.offsetWidth, canvas.offsetHeight, false);
                    }
                    this.cropper.setImage(img);
                    if (this.cropPosition && this.cropPosition.isInitialized()) {
                        this.cropper.updateCropPosition(this.cropPosition.toBounds());
                    }
                    this.image.original = img;
                    let bounds = this.cropper.getCropBounds();
                    this.image.image = this.cropper.getCroppedImageHelper().src;
                    if (!this.image) {
                        this.image = image;
                    }
                    if (newBounds != null) {
                        bounds = newBounds;
                        this.cropper.setBounds(bounds);
                        this.cropper.updateCropPosition(bounds);
                    }
                    this.onCrop.emit(bounds);
                });
            }
        });
    }
    isCropPositionChanged(changes) {
        if (this.cropper &&
            changes.cropPosition &&
            this.isCropPositionUpdateNeeded) {
            return true;
        }
        else {
            this.isCropPositionUpdateNeeded = true;
            return false;
        }
    }
    updateCropBounds() {
        const cropBound = this.cropper.getCropBounds();
        this.cropPositionChange.emit(new CropPosition(cropBound.left, cropBound.top, cropBound.width, cropBound.height));
        this.isCropPositionUpdateNeeded = false;
    }
    getOrientedImage(image, callback) {
        let img;
        this.exif.getData(image, () => {
            const orientation = this.exif.getTag(image, 'Orientation');
            if ([3, 6, 8].indexOf(orientation) > -1) {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                let cw = image.width;
                let ch = image.height;
                let cx = 0;
                let cy = 0;
                let deg = 0;
                switch (orientation) {
                    case 3:
                        cx = -image.width;
                        cy = -image.height;
                        deg = 180;
                        break;
                    case 6:
                        cw = image.height;
                        ch = image.width;
                        cy = -image.height;
                        deg = 90;
                        break;
                    case 8:
                        cw = image.height;
                        ch = image.width;
                        cx = -image.width;
                        deg = 270;
                        break;
                    default:
                        break;
                }
                canvas.width = cw;
                canvas.height = ch;
                ctx.rotate((deg * Math.PI) / 180);
                ctx.drawImage(image, cx, cy);
                img = document.createElement('img');
                img.width = cw;
                img.height = ch;
                img.addEventListener('load', () => {
                    callback(img);
                });
                img.src = canvas.toDataURL('image/png');
            }
            else {
                img = image;
                callback(img);
            }
        });
    }
};
ImageCropperComponent.ɵfac = function ImageCropperComponent_Factory(t) { return new (t || ImageCropperComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(DOCUMENT)); };
ImageCropperComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ImageCropperComponent, selectors: [["img-cropper"]], viewQuery: function ImageCropperComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵstaticViewQuery(_c0, true);
        ɵngcc0.ɵɵviewQuery(_c1, true);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.cropcanvas = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.fileInput = _t.first);
    } }, inputs: { settings: "settings", cropper: "cropper", image: "image", inputImage: "inputImage", cropPosition: "cropPosition" }, outputs: { cropPositionChange: "cropPositionChange", onCrop: "onCrop", imageSet: "imageSet" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], decls: 4, vars: 1, consts: [[1, "ng2-imgcrop"], ["type", "file", "accept", "image/*", 3, "change", 4, "ngIf"], [3, "mousedown", "touchmove", "touchend", "touchstart"], ["cropcanvas", ""], ["type", "file", "accept", "image/*", 3, "change"], ["fileInput", ""]], template: function ImageCropperComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "span", 0);
        ɵngcc0.ɵɵtemplate(1, ImageCropperComponent_input_1_Template, 2, 0, "input", 1);
        ɵngcc0.ɵɵelementStart(2, "canvas", 2, 3);
        ɵngcc0.ɵɵlistener("mousedown", function ImageCropperComponent_Template_canvas_mousedown_2_listener($event) { return ctx.onMouseDown($event); })("touchmove", function ImageCropperComponent_Template_canvas_touchmove_2_listener($event) { return ctx.onTouchMove($event); })("touchend", function ImageCropperComponent_Template_canvas_touchend_2_listener($event) { return ctx.onTouchEnd($event); })("touchstart", function ImageCropperComponent_Template_canvas_touchstart_2_listener($event) { return ctx.onTouchStart($event); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.settings.noFileInput);
    } }, directives: [ɵngcc1.NgIf], encapsulation: 2 });
ImageCropperComponent.ctorParameters = () => [
    { type: Renderer2 },
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }
];
__decorate([
    ViewChild('cropcanvas', { static: true }),
    __metadata("design:type", ElementRef)
], ImageCropperComponent.prototype, "cropcanvas", void 0);
__decorate([
    ViewChild('fileInput'),
    __metadata("design:type", ElementRef)
], ImageCropperComponent.prototype, "fileInput", void 0);
__decorate([
    Input(),
    __metadata("design:type", CropperSettings)
], ImageCropperComponent.prototype, "settings", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], ImageCropperComponent.prototype, "image", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], ImageCropperComponent.prototype, "inputImage", void 0);
__decorate([
    Input(),
    __metadata("design:type", ImageCropper)
], ImageCropperComponent.prototype, "cropper", void 0);
__decorate([
    Input(),
    __metadata("design:type", CropPosition)
], ImageCropperComponent.prototype, "cropPosition", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ImageCropperComponent.prototype, "cropPositionChange", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ImageCropperComponent.prototype, "onCrop", void 0);
__decorate([
    Output(),
    __metadata("design:type", EventEmitter)
], ImageCropperComponent.prototype, "imageSet", void 0);
ImageCropperComponent = __decorate([ __param(1, Inject(DOCUMENT)),
    __metadata("design:paramtypes", [Renderer2, Object])
], ImageCropperComponent);
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ImageCropperComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: 'img-cropper',
                template: "<span class=\"ng2-imgcrop\">\r\n  <input\r\n    *ngIf=\"!settings.noFileInput\"\r\n    #fileInput\r\n    type=\"file\"\r\n    accept=\"image/*\"\r\n    (change)=\"fileChangeListener($event)\"\r\n  />\r\n  <canvas\r\n    #cropcanvas\r\n    (mousedown)=\"onMouseDown($event)\"\r\n    (touchmove)=\"onTouchMove($event)\"\r\n    (touchend)=\"onTouchEnd($event)\"\r\n    (touchstart)=\"onTouchStart($event)\"\r\n  >\r\n  </canvas>\r\n</span>\r\n"
            }]
    }], function () { return [{ type: ɵngcc0.Renderer2 }, { type: undefined, decorators: [{
                type: Inject,
                args: [DOCUMENT]
            }] }]; }, { cropPositionChange: [{
            type: Output
        }], onCrop: [{
            type: Output
        }], imageSet: [{
            type: Output
        }], settings: [{
            type: Input
        }], cropper: [{
            type: Input
        }], image: [{
            type: Input
        }], cropcanvas: [{
            type: ViewChild,
            args: ['cropcanvas', { static: true }]
        }], fileInput: [{
            type: ViewChild,
            args: ['fileInput']
        }], inputImage: [{
            type: Input
        }], cropPosition: [{
            type: Input
        }] }); })();
export { ImageCropperComponent };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW1hZ2UtY3JvcHBlci5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbIm5neC1pbWctY3JvcHBlci9saWIvaW1hZ2UtY3JvcHBlci9pbWFnZS1jcm9wcGVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUNMLFNBQVMsRUFDVCxhQUFhLEVBQ2IsU0FBUyxFQUNULFNBQVMsRUFDVCxTQUFTLEVBQ1QsVUFBVSxFQUNWLEtBQUssRUFDTCxNQUFNLEVBQ04sWUFBWSxFQUNaLFNBQVMsRUFDVCxhQUFhLEVBQUUsTUFBTSxFQUN0QixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sb0JBQW9CLENBQUMsckRBQXJELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNyRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sZ0JBQWdCLENBQUMsOUNBQTlDLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUM5QyxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sc0JBQXNCLENBQUMscERBQXBELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUVwRCxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sUUFBUSxDQUFDLDlCQUE5QixPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sUUFBUSxDQUFDO0FBQzlCLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQywzQ0FBM0MsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBTzNDLElBQWEscUJBQXFCLEdBQWxDLE1BQWE7Y0FBcUIsT0FnQ2hDLFlBQVksUUFBbUI7QUFDTztPQUFRLFlBQVI7SUFBUSxHQUFSLFFBQVEsQ0FBQSxTQXJCdkM7cUJBQWtCLEdBQStCLElBQUksWUFBWSxFQUVyRSxDQUFDLFNBRUksU0FBSSxHQUFHLElBQUksSUFBSTtDQUFFLENBQUMsU0FFMUI7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QXJCLEtBQUssRUFBRTtBQUFFLDhCQUFnQixlQUFlO0FBQzNDLHVEQUQ0QztBQUNqQztBQUFhLElBQXJCLEtBQUssRUFBRTtBQUFFO0FBQ1Esb0RBRFM7QUFDbEI7QUFBYSxJQUFyQixLQUFLLEVBQUU7QUFBRTtBQUNHLHlEQURtQjtBQUN2QjtBQUFhLElBQXJCLEtBQUssRUFBRTtBQUFFLDhCQUFlLFlBQVk7QUFDdkMsc0RBRHdDO0FBQzdCO0FBQWEsSUFBckIsS0FBSyxFQUFFO0FBQUUsOEJBQW9CLFlBQVk7QUFDNUMsMkRBRDZDO0FBRTNDO0FBQWEsSUFEWixNQUFNLEVBQUU7QUFDViw4QkFBNEIsWUFBWTtBQUFFLGlFQUVyQztBQUtNO0FBQWEsSUFBdEIsTUFBTSxFQUFFO0FBQUUsOEJBQWMsWUFBWTtBQUFFLHFEQUF5QjtBQUN0RDtBQUFhLElBQXRCLE1BQU0sRUFBRTtBQUFFLDhCQUFTLFlBQVk7QUFBRSx1REFBc0M7QUFwQjdELHFCQUFxQixvQkFMakMsU0FBUyxDQUFDLFVBQ1QsekJBSUUsQ0FpQ1csV0FBQSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUE7d0NBckNpQixTQUM5QyxqREFvQytCLHFDQURULFNBQVM7QUFuQ3ZCLEVBQUUsYUFBYSxVQUN2Qix6QkFtQ08sR0FqQ0kscUJBQXFCLENBbVVqQzs7Ozs7O2dPQXJVOEMsTUFDOUMsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQXFVRjs7QUE3VkEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBDb21wb25lbnQsXHJcbiAgQWZ0ZXJWaWV3SW5pdCxcclxuICBPbkNoYW5nZXMsXHJcbiAgT25EZXN0cm95LFxyXG4gIFZpZXdDaGlsZCxcclxuICBFbGVtZW50UmVmLFxyXG4gIElucHV0LFxyXG4gIE91dHB1dCxcclxuICBFdmVudEVtaXR0ZXIsXHJcbiAgUmVuZGVyZXIyLFxyXG4gIFNpbXBsZUNoYW5nZXMsIEluamVjdFxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBDcm9wcGVyU2V0dGluZ3MgfSBmcm9tICcuL2Nyb3BwZXItc2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBJbWFnZUNyb3BwZXIgfSBmcm9tICcuL2ltYWdlQ3JvcHBlcic7XHJcbmltcG9ydCB7IENyb3BQb3NpdGlvbiB9IGZyb20gJy4vbW9kZWwvY3JvcFBvc2l0aW9uJztcclxuaW1wb3J0IHsgQm91bmRzIH0gZnJvbSAnLi9tb2RlbC9ib3VuZHMnO1xyXG5pbXBvcnQgeyBFeGlmIH0gZnJvbSAnLi9leGlmJztcclxuaW1wb3J0IHsgRE9DVU1FTlQgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmNvbXBvbmVudC1zZWxlY3RvclxyXG4gIHNlbGVjdG9yOiAnaW1nLWNyb3BwZXInLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9pbWFnZS1jcm9wcGVyLmNvbXBvbmVudC5odG1sJ1xyXG59KVxyXG5leHBvcnQgY2xhc3MgSW1hZ2VDcm9wcGVyQ29tcG9uZW50XHJcbiAgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSB7XHJcbiAgQFZpZXdDaGlsZCgnY3JvcGNhbnZhcycsIHsgc3RhdGljOiB0cnVlIH0pXHJcbiAgY3JvcGNhbnZhczogRWxlbWVudFJlZjtcclxuICBAVmlld0NoaWxkKCdmaWxlSW5wdXQnKSBmaWxlSW5wdXQ6IEVsZW1lbnRSZWY7XHJcblxyXG4gIEBJbnB1dCgpIHB1YmxpYyBzZXR0aW5nczogQ3JvcHBlclNldHRpbmdzO1xyXG4gIEBJbnB1dCgpIHB1YmxpYyBpbWFnZTogYW55O1xyXG4gIEBJbnB1dCgpIHB1YmxpYyBpbnB1dEltYWdlOiBhbnk7XHJcbiAgQElucHV0KCkgcHVibGljIGNyb3BwZXI6IEltYWdlQ3JvcHBlcjtcclxuICBASW5wdXQoKSBwdWJsaWMgY3JvcFBvc2l0aW9uOiBDcm9wUG9zaXRpb247XHJcbiAgQE91dHB1dCgpXHJcbiAgcHVibGljIGNyb3BQb3NpdGlvbkNoYW5nZTogRXZlbnRFbWl0dGVyPENyb3BQb3NpdGlvbj4gPSBuZXcgRXZlbnRFbWl0dGVyPFxyXG4gICAgQ3JvcFBvc2l0aW9uXHJcbiAgPigpO1xyXG5cclxuICBwcml2YXRlIGV4aWYgPSBuZXcgRXhpZigpO1xyXG5cclxuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tb3V0cHV0LW9uLXByZWZpeFxyXG4gIEBPdXRwdXQoKSBwdWJsaWMgb25Dcm9wOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBAT3V0cHV0KCkgaW1hZ2VTZXQ6IEV2ZW50RW1pdHRlcjxib29sZWFuPiA9IG5ldyBFdmVudEVtaXR0ZXI8Ym9vbGVhbj4oKTtcclxuXHJcbiAgcHVibGljIGNyb3BwZWRXaWR0aDogbnVtYmVyO1xyXG4gIHB1YmxpYyBjcm9wcGVkSGVpZ2h0OiBudW1iZXI7XHJcbiAgcHVibGljIGludGVydmFsUmVmOiBudW1iZXI7XHJcbiAgcHVibGljIHJhZjogbnVtYmVyO1xyXG4gIHB1YmxpYyByZW5kZXJlcjogUmVuZGVyZXIyO1xyXG4gIHB1YmxpYyB3aW5kb3dMaXN0ZW5lcjogRXZlbnRMaXN0ZW5lck9iamVjdDtcclxuXHJcbiAgcHJpdmF0ZSBpc0Nyb3BQb3NpdGlvblVwZGF0ZU5lZWRlZDogYm9vbGVhbjtcclxuICBwcml2YXRlIGRyYWdVbnN1YnNjcmliZXJzOiAoKCkgPT4gdm9pZClbXSA9IFtdO1xyXG5cclxuICBjb25zdHJ1Y3RvcihyZW5kZXJlcjogUmVuZGVyZXIyLFxyXG4gICAgICAgICAgICAgIEBJbmplY3QoRE9DVU1FTlQpIHByaXZhdGUgZG9jdW1lbnQpIHtcclxuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcbiAgICBjb25zdCBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50ID0gdGhpcy5jcm9wY2FudmFzLm5hdGl2ZUVsZW1lbnQ7XHJcblxyXG4gICAgaWYgKCF0aGlzLnNldHRpbmdzKSB7XHJcbiAgICAgIHRoaXMuc2V0dGluZ3MgPSBuZXcgQ3JvcHBlclNldHRpbmdzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MuY3JvcHBlckNsYXNzKSB7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuc2V0QXR0cmlidXRlKGNhbnZhcywgJ2NsYXNzJywgdGhpcy5zZXR0aW5ncy5jcm9wcGVyQ2xhc3MpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghdGhpcy5zZXR0aW5ncy5keW5hbWljU2l6aW5nKSB7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuc2V0QXR0cmlidXRlKFxyXG4gICAgICAgIGNhbnZhcyxcclxuICAgICAgICAnd2lkdGgnLFxyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MuY2FudmFzV2lkdGgudG9TdHJpbmcoKVxyXG4gICAgICApO1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZShcclxuICAgICAgICBjYW52YXMsXHJcbiAgICAgICAgJ2hlaWdodCcsXHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5jYW52YXNIZWlnaHQudG9TdHJpbmcoKVxyXG4gICAgICApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy53aW5kb3dMaXN0ZW5lciA9IHRoaXMucmVzaXplLmJpbmQodGhpcyk7XHJcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLndpbmRvd0xpc3RlbmVyKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXRoaXMuY3JvcHBlcikge1xyXG4gICAgICB0aGlzLmNyb3BwZXIgPSBuZXcgSW1hZ2VDcm9wcGVyKHRoaXMuc2V0dGluZ3MpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuY3JvcHBlci5wcmVwYXJlKGNhbnZhcyk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuaXNDcm9wUG9zaXRpb25DaGFuZ2VkKGNoYW5nZXMpKSB7XHJcbiAgICAgIHRoaXMuY3JvcHBlci51cGRhdGVDcm9wUG9zaXRpb24odGhpcy5jcm9wUG9zaXRpb24udG9Cb3VuZHMoKSk7XHJcbiAgICAgIGlmICh0aGlzLmNyb3BwZXIuaXNJbWFnZVNldCgpKSB7XHJcbiAgICAgICAgY29uc3QgYm91bmRzID0gdGhpcy5jcm9wcGVyLmdldENyb3BCb3VuZHMoKTtcclxuICAgICAgICB0aGlzLmltYWdlLmltYWdlID0gdGhpcy5jcm9wcGVyLmdldENyb3BwZWRJbWFnZUhlbHBlcigpLnNyYztcclxuICAgICAgICB0aGlzLm9uQ3JvcC5lbWl0KGJvdW5kcyk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy51cGRhdGVDcm9wQm91bmRzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGNoYW5nZXMuaW5wdXRJbWFnZSkge1xyXG4gICAgICB0aGlzLnNldEltYWdlKGNoYW5nZXMuaW5wdXRJbWFnZS5jdXJyZW50VmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChjaGFuZ2VzLnNldHRpbmdzICYmIHRoaXMuY3JvcHBlcikge1xyXG4gICAgICB0aGlzLmNyb3BwZXIudXBkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XHJcbiAgICAgIGlmICh0aGlzLmNyb3BwZXIuaXNJbWFnZVNldCgpKSB7XHJcbiAgICAgICAgdGhpcy5pbWFnZS5pbWFnZSA9IHRoaXMuY3JvcHBlci5nZXRDcm9wcGVkSW1hZ2VIZWxwZXIoKS5zcmM7XHJcbiAgICAgICAgdGhpcy5vbkNyb3AuZW1pdCh0aGlzLmNyb3BwZXIuZ2V0Q3JvcEJvdW5kcygpKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIG5nT25EZXN0cm95KCkge1xyXG4gICAgdGhpcy5yZW1vdmVEcmFnTGlzdGVuZXJzKCk7XHJcbiAgICBpZiAodGhpcy5zZXR0aW5ncy5keW5hbWljU2l6aW5nICYmIHRoaXMud2luZG93TGlzdGVuZXIpIHtcclxuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMud2luZG93TGlzdGVuZXIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIG9uVG91Y2hNb3ZlKGV2ZW50OiBUb3VjaEV2ZW50KTogdm9pZCB7XHJcbiAgICB0aGlzLmNyb3BwZXIub25Ub3VjaE1vdmUoZXZlbnQpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG9uVG91Y2hTdGFydChldmVudDogVG91Y2hFdmVudCk6IHZvaWQge1xyXG4gICAgdGhpcy5jcm9wcGVyLm9uVG91Y2hTdGFydChldmVudCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb25Ub3VjaEVuZChldmVudDogVG91Y2hFdmVudCk6IHZvaWQge1xyXG4gICAgdGhpcy5jcm9wcGVyLm9uVG91Y2hFbmQoZXZlbnQpO1xyXG4gICAgaWYgKHRoaXMuY3JvcHBlci5pc0ltYWdlU2V0KCkpIHtcclxuICAgICAgdGhpcy5pbWFnZS5pbWFnZSA9IHRoaXMuY3JvcHBlci5nZXRDcm9wcGVkSW1hZ2VIZWxwZXIoKS5zcmM7XHJcbiAgICAgIHRoaXMub25Dcm9wLmVtaXQodGhpcy5jcm9wcGVyLmdldENyb3BCb3VuZHMoKSk7XHJcbiAgICAgIHRoaXMudXBkYXRlQ3JvcEJvdW5kcygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIG9uTW91c2VEb3duKGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XHJcbiAgICB0aGlzLmRyYWdVbnN1YnNjcmliZXJzLnB1c2godGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5kb2N1bWVudCwgJ21vdXNlbW92ZScsIHRoaXMub25Nb3VzZU1vdmUuYmluZCh0aGlzKSkpO1xyXG4gICAgdGhpcy5kcmFnVW5zdWJzY3JpYmVycy5wdXNoKHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZG9jdW1lbnQsICdtb3VzZXVwJywgdGhpcy5vbk1vdXNlVXAuYmluZCh0aGlzKSkpO1xyXG5cclxuICAgIHRoaXMuY3JvcHBlci5vbk1vdXNlRG93bihldmVudCk7XHJcbiAgICAvLyBpZiAoIXRoaXMuY3JvcHBlci5pc0ltYWdlU2V0KCkgJiYgIXRoaXMuc2V0dGluZ3Mubm9GaWxlSW5wdXQpIHtcclxuICAgIC8vICAgLy8gbG9hZCBpbWdcclxuICAgIC8vICAgdGhpcy5maWxlSW5wdXQubmF0aXZlRWxlbWVudC5jbGljaygpO1xyXG4gICAgLy8gfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSByZW1vdmVEcmFnTGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5kcmFnVW5zdWJzY3JpYmVycy5mb3JFYWNoKHVuc3Vic2NyaWJlID0+IHVuc3Vic2NyaWJlKCkpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG9uTW91c2VVcChldmVudDogTW91c2VFdmVudCk6IHZvaWQge1xyXG4gICAgdGhpcy5yZW1vdmVEcmFnTGlzdGVuZXJzKCk7XHJcbiAgICBpZiAodGhpcy5jcm9wcGVyLmlzSW1hZ2VTZXQoKSkge1xyXG4gICAgICB0aGlzLmNyb3BwZXIub25Nb3VzZVVwKGV2ZW50KTtcclxuICAgICAgdGhpcy5pbWFnZS5pbWFnZSA9IHRoaXMuY3JvcHBlci5nZXRDcm9wcGVkSW1hZ2VIZWxwZXIoKS5zcmM7XHJcbiAgICAgIHRoaXMub25Dcm9wLmVtaXQodGhpcy5jcm9wcGVyLmdldENyb3BCb3VuZHMoKSk7XHJcbiAgICAgIHRoaXMudXBkYXRlQ3JvcEJvdW5kcygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIG9uTW91c2VNb3ZlKGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XHJcbiAgICB0aGlzLmNyb3BwZXIub25Nb3VzZU1vdmUoZXZlbnQpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGZpbGVDaGFuZ2VMaXN0ZW5lcigkZXZlbnQ6IGFueSkge1xyXG4gICAgaWYgKCRldmVudC50YXJnZXQuZmlsZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBmaWxlOiBGaWxlID0gJGV2ZW50LnRhcmdldC5maWxlc1swXTtcclxuICAgIGlmICh0aGlzLnNldHRpbmdzLmFsbG93ZWRGaWxlc1JlZ2V4LnRlc3QoZmlsZS5uYW1lKSkge1xyXG4gICAgICBjb25zdCBpbWFnZTogYW55ID0gbmV3IEltYWdlKCk7XHJcbiAgICAgIGNvbnN0IGZpbGVSZWFkZXI6IEZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG5cclxuICAgICAgZmlsZVJlYWRlci5hZGRFdmVudExpc3RlbmVyKCdsb2FkZW5kJywgKGxvYWRFdmVudDogYW55KSA9PiB7XHJcbiAgICAgICAgaW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuc2V0SW1hZ2UoaW1hZ2UpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGltYWdlLnNyYyA9IGxvYWRFdmVudC50YXJnZXQucmVzdWx0O1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGZpbGVSZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgcmVzaXplKCkge1xyXG4gICAgY29uc3QgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCA9IHRoaXMuY3JvcGNhbnZhcy5uYXRpdmVFbGVtZW50O1xyXG4gICAgdGhpcy5zZXR0aW5ncy5jYW52YXNXaWR0aCA9IGNhbnZhcy5vZmZzZXRXaWR0aDtcclxuICAgIHRoaXMuc2V0dGluZ3MuY2FudmFzSGVpZ2h0ID0gY2FudmFzLm9mZnNldEhlaWdodDtcclxuICAgIHRoaXMuY3JvcHBlci5yZXNpemVDYW52YXMoY2FudmFzLm9mZnNldFdpZHRoLCBjYW52YXMub2Zmc2V0SGVpZ2h0LCB0cnVlKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyByZXNldCgpOiB2b2lkIHtcclxuICAgIHRoaXMuY3JvcHBlci5yZXNldCgpO1xyXG4gICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUoXHJcbiAgICAgIHRoaXMuY3JvcGNhbnZhcy5uYXRpdmVFbGVtZW50LFxyXG4gICAgICAnY2xhc3MnLFxyXG4gICAgICB0aGlzLnNldHRpbmdzLmNyb3BwZXJDbGFzc1xyXG4gICAgKTtcclxuICAgIHRoaXMuaW1hZ2UuaW1hZ2UgPSB0aGlzLmNyb3BwZXIuZ2V0Q3JvcHBlZEltYWdlSGVscGVyKCkuc3JjO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldEltYWdlKGltYWdlOiBIVE1MSW1hZ2VFbGVtZW50LCBuZXdCb3VuZHM6IGFueSA9IG51bGwpIHtcclxuICAgIHRoaXMuaW1hZ2VTZXQuZW1pdCh0cnVlKTtcclxuICAgIHRoaXMucmVuZGVyZXIuc2V0QXR0cmlidXRlKFxyXG4gICAgICB0aGlzLmNyb3BjYW52YXMubmF0aXZlRWxlbWVudCxcclxuICAgICAgJ2NsYXNzJyxcclxuICAgICAgYCR7dGhpcy5zZXR0aW5ncy5jcm9wcGVyQ2xhc3N9ICR7dGhpcy5zZXR0aW5ncy5jcm9wcGluZ0NsYXNzfWBcclxuICAgICk7XHJcbiAgICB0aGlzLnJhZiA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xyXG4gICAgICBpZiAodGhpcy5yYWYpIHtcclxuICAgICAgICB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5yYWYpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChpbWFnZS5uYXR1cmFsSGVpZ2h0ID4gMCAmJiBpbWFnZS5uYXR1cmFsV2lkdGggPiAwKSB7XHJcbiAgICAgICAgaW1hZ2UuaGVpZ2h0ID0gaW1hZ2UubmF0dXJhbEhlaWdodDtcclxuICAgICAgICBpbWFnZS53aWR0aCA9IGltYWdlLm5hdHVyYWxXaWR0aDtcclxuXHJcbiAgICAgICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMucmFmKTtcclxuICAgICAgICB0aGlzLmdldE9yaWVudGVkSW1hZ2UoaW1hZ2UsIChpbWc6IEhUTUxJbWFnZUVsZW1lbnQpID0+IHtcclxuICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmR5bmFtaWNTaXppbmcpIHtcclxuICAgICAgICAgICAgY29uc3QgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCA9IHRoaXMuY3JvcGNhbnZhcy5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmNhbnZhc1dpZHRoID0gY2FudmFzLm9mZnNldFdpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmNhbnZhc0hlaWdodCA9IGNhbnZhcy5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgICAgICAgIHRoaXMuY3JvcHBlci5yZXNpemVDYW52YXMoXHJcbiAgICAgICAgICAgICAgY2FudmFzLm9mZnNldFdpZHRoLFxyXG4gICAgICAgICAgICAgIGNhbnZhcy5vZmZzZXRIZWlnaHQsXHJcbiAgICAgICAgICAgICAgZmFsc2VcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB0aGlzLmNyb3BwZXIuc2V0SW1hZ2UoaW1nKTtcclxuICAgICAgICAgIGlmICh0aGlzLmNyb3BQb3NpdGlvbiAmJiB0aGlzLmNyb3BQb3NpdGlvbi5pc0luaXRpYWxpemVkKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5jcm9wcGVyLnVwZGF0ZUNyb3BQb3NpdGlvbih0aGlzLmNyb3BQb3NpdGlvbi50b0JvdW5kcygpKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB0aGlzLmltYWdlLm9yaWdpbmFsID0gaW1nO1xyXG4gICAgICAgICAgbGV0IGJvdW5kcyA9IHRoaXMuY3JvcHBlci5nZXRDcm9wQm91bmRzKCk7XHJcbiAgICAgICAgICB0aGlzLmltYWdlLmltYWdlID0gdGhpcy5jcm9wcGVyLmdldENyb3BwZWRJbWFnZUhlbHBlcigpLnNyYztcclxuXHJcbiAgICAgICAgICBpZiAoIXRoaXMuaW1hZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5pbWFnZSA9IGltYWdlO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGlmIChuZXdCb3VuZHMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBib3VuZHMgPSBuZXdCb3VuZHM7XHJcbiAgICAgICAgICAgIHRoaXMuY3JvcHBlci5zZXRCb3VuZHMoYm91bmRzKTtcclxuICAgICAgICAgICAgdGhpcy5jcm9wcGVyLnVwZGF0ZUNyb3BQb3NpdGlvbihib3VuZHMpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5vbkNyb3AuZW1pdChib3VuZHMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgaXNDcm9wUG9zaXRpb25DaGFuZ2VkKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiBib29sZWFuIHtcclxuICAgIGlmIChcclxuICAgICAgdGhpcy5jcm9wcGVyICYmXHJcbiAgICAgIGNoYW5nZXMuY3JvcFBvc2l0aW9uICYmXHJcbiAgICAgIHRoaXMuaXNDcm9wUG9zaXRpb25VcGRhdGVOZWVkZWRcclxuICAgICkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuaXNDcm9wUG9zaXRpb25VcGRhdGVOZWVkZWQgPSB0cnVlO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZUNyb3BCb3VuZHMoKTogdm9pZCB7XHJcbiAgICBjb25zdCBjcm9wQm91bmQ6IEJvdW5kcyA9IHRoaXMuY3JvcHBlci5nZXRDcm9wQm91bmRzKCk7XHJcbiAgICB0aGlzLmNyb3BQb3NpdGlvbkNoYW5nZS5lbWl0KFxyXG4gICAgICBuZXcgQ3JvcFBvc2l0aW9uKFxyXG4gICAgICAgIGNyb3BCb3VuZC5sZWZ0LFxyXG4gICAgICAgIGNyb3BCb3VuZC50b3AsXHJcbiAgICAgICAgY3JvcEJvdW5kLndpZHRoLFxyXG4gICAgICAgIGNyb3BCb3VuZC5oZWlnaHRcclxuICAgICAgKVxyXG4gICAgKTtcclxuICAgIHRoaXMuaXNDcm9wUG9zaXRpb25VcGRhdGVOZWVkZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0T3JpZW50ZWRJbWFnZShcclxuICAgIGltYWdlOiBIVE1MSW1hZ2VFbGVtZW50LFxyXG4gICAgY2FsbGJhY2s6IChpbWc6IEhUTUxJbWFnZUVsZW1lbnQpID0+IHZvaWRcclxuICApIHtcclxuICAgIGxldCBpbWc6IGFueTtcclxuXHJcbiAgICB0aGlzLmV4aWYuZ2V0RGF0YShpbWFnZSwgKCkgPT4ge1xyXG4gICAgICBjb25zdCBvcmllbnRhdGlvbiA9IHRoaXMuZXhpZi5nZXRUYWcoaW1hZ2UsICdPcmllbnRhdGlvbicpO1xyXG5cclxuICAgICAgaWYgKFszLCA2LCA4XS5pbmRleE9mKG9yaWVudGF0aW9uKSA+IC0xKSB7XHJcbiAgICAgICAgY29uc3QgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgICAgIGNvbnN0IGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEID0gY2FudmFzLmdldENvbnRleHQoXHJcbiAgICAgICAgICAnMmQnXHJcbiAgICAgICAgKSBhcyBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XHJcbiAgICAgICAgbGV0IGN3OiBudW1iZXIgPSBpbWFnZS53aWR0aDtcclxuICAgICAgICBsZXQgY2g6IG51bWJlciA9IGltYWdlLmhlaWdodDtcclxuICAgICAgICBsZXQgY3ggPSAwO1xyXG4gICAgICAgIGxldCBjeSA9IDA7XHJcbiAgICAgICAgbGV0IGRlZyA9IDA7XHJcblxyXG4gICAgICAgIHN3aXRjaCAob3JpZW50YXRpb24pIHtcclxuICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgY3ggPSAtaW1hZ2Uud2lkdGg7XHJcbiAgICAgICAgICAgIGN5ID0gLWltYWdlLmhlaWdodDtcclxuICAgICAgICAgICAgZGVnID0gMTgwO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgNjpcclxuICAgICAgICAgICAgY3cgPSBpbWFnZS5oZWlnaHQ7XHJcbiAgICAgICAgICAgIGNoID0gaW1hZ2Uud2lkdGg7XHJcbiAgICAgICAgICAgIGN5ID0gLWltYWdlLmhlaWdodDtcclxuICAgICAgICAgICAgZGVnID0gOTA7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSA4OlxyXG4gICAgICAgICAgICBjdyA9IGltYWdlLmhlaWdodDtcclxuICAgICAgICAgICAgY2ggPSBpbWFnZS53aWR0aDtcclxuICAgICAgICAgICAgY3ggPSAtaW1hZ2Uud2lkdGg7XHJcbiAgICAgICAgICAgIGRlZyA9IDI3MDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhbnZhcy53aWR0aCA9IGN3O1xyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBjaDtcclxuICAgICAgICBjdHgucm90YXRlKChkZWcgKiBNYXRoLlBJKSAvIDE4MCk7XHJcbiAgICAgICAgY3R4LmRyYXdJbWFnZShpbWFnZSwgY3gsIGN5KTtcclxuICAgICAgICBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICAgICAgICBpbWcud2lkdGggPSBjdztcclxuICAgICAgICBpbWcuaGVpZ2h0ID0gY2g7XHJcbiAgICAgICAgaW1nLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XHJcbiAgICAgICAgICBjYWxsYmFjayhpbWcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGltZy5zcmMgPSBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpbWcgPSBpbWFnZTtcclxuICAgICAgICBjYWxsYmFjayhpbWcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIl19