{"ast":null,"code":"/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar VisualMapModel = require(\"./VisualMapModel\");\n\nvar numberUtil = require(\"../../util/number\");\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\n// Constant\n\n\nvar DEFAULT_BAR_BOUND = [20, 140];\nvar ContinuousModel = VisualMapModel.extend({\n  type: 'visualMap.continuous',\n\n  /**\r\n   * @protected\r\n   */\n  defaultOption: {\n    align: 'auto',\n    // 'auto', 'left', 'right', 'top', 'bottom'\n    calculable: false,\n    // This prop effect default component type determine,\n    // See echarts/component/visualMap/typeDefaulter.\n    range: null,\n    // selected range. In default case `range` is [min, max]\n    // and can auto change along with modification of min max,\n    // util use specifid a range.\n    realtime: true,\n    // Whether realtime update.\n    itemHeight: null,\n    // The length of the range control edge.\n    itemWidth: null,\n    // The length of the other side.\n    hoverLink: true,\n    // Enable hover highlight.\n    hoverLinkDataSize: null,\n    // The size of hovered data.\n    hoverLinkOnHandle: null // Whether trigger hoverLink when hover handle.\n    // If not specified, follow the value of `realtime`.\n\n  },\n\n  /**\r\n   * @override\r\n   */\n  optionUpdated: function optionUpdated(newOption, isInit) {\n    ContinuousModel.superApply(this, 'optionUpdated', arguments);\n    this.resetExtent();\n    this.resetVisual(function (mappingOption) {\n      mappingOption.mappingMethod = 'linear';\n      mappingOption.dataExtent = this.getExtent();\n    });\n\n    this._resetRange();\n  },\n\n  /**\r\n   * @protected\r\n   * @override\r\n   */\n  resetItemSize: function resetItemSize() {\n    ContinuousModel.superApply(this, 'resetItemSize', arguments);\n    var itemSize = this.itemSize;\n    this._orient === 'horizontal' && itemSize.reverse();\n    (itemSize[0] == null || isNaN(itemSize[0])) && (itemSize[0] = DEFAULT_BAR_BOUND[0]);\n    (itemSize[1] == null || isNaN(itemSize[1])) && (itemSize[1] = DEFAULT_BAR_BOUND[1]);\n  },\n\n  /**\r\n   * @private\r\n   */\n  _resetRange: function _resetRange() {\n    var dataExtent = this.getExtent();\n    var range = this.option.range;\n\n    if (!range || range.auto) {\n      // `range` should always be array (so we dont use other\n      // value like 'auto') for user-friend. (consider getOption).\n      dataExtent.auto = 1;\n      this.option.range = dataExtent;\n    } else if (zrUtil.isArray(range)) {\n      if (range[0] > range[1]) {\n        range.reverse();\n      }\n\n      range[0] = Math.max(range[0], dataExtent[0]);\n      range[1] = Math.min(range[1], dataExtent[1]);\n    }\n  },\n\n  /**\r\n   * @protected\r\n   * @override\r\n   */\n  completeVisualOption: function completeVisualOption() {\n    VisualMapModel.prototype.completeVisualOption.apply(this, arguments);\n    zrUtil.each(this.stateList, function (state) {\n      var symbolSize = this.option.controller[state].symbolSize;\n\n      if (symbolSize && symbolSize[0] !== symbolSize[1]) {\n        symbolSize[0] = 0; // For good looking.\n      }\n    }, this);\n  },\n\n  /**\r\n   * @override\r\n   */\n  setSelected: function setSelected(selected) {\n    this.option.range = selected.slice();\n\n    this._resetRange();\n  },\n\n  /**\r\n   * @public\r\n   */\n  getSelected: function getSelected() {\n    var dataExtent = this.getExtent();\n    var dataInterval = numberUtil.asc((this.get('range') || []).slice()); // Clamp\n\n    dataInterval[0] > dataExtent[1] && (dataInterval[0] = dataExtent[1]);\n    dataInterval[1] > dataExtent[1] && (dataInterval[1] = dataExtent[1]);\n    dataInterval[0] < dataExtent[0] && (dataInterval[0] = dataExtent[0]);\n    dataInterval[1] < dataExtent[0] && (dataInterval[1] = dataExtent[0]);\n    return dataInterval;\n  },\n\n  /**\r\n   * @override\r\n   */\n  getValueState: function getValueState(value) {\n    var range = this.option.range;\n    var dataExtent = this.getExtent(); // When range[0] === dataExtent[0], any value larger than dataExtent[0] maps to 'inRange'.\n    // range[1] is processed likewise.\n\n    return (range[0] <= dataExtent[0] || range[0] <= value) && (range[1] >= dataExtent[1] || value <= range[1]) ? 'inRange' : 'outOfRange';\n  },\n\n  /**\r\n   * @params {Array.<number>} range target value: range[0] <= value && value <= range[1]\r\n   * @return {Array.<Object>} [{seriesId, dataIndices: <Array.<number>>}, ...]\r\n   */\n  findTargetDataIndices: function findTargetDataIndices(range) {\n    var result = [];\n    this.eachTargetSeries(function (seriesModel) {\n      var dataIndices = [];\n      var data = seriesModel.getData();\n      data.each(this.getDataDimension(data), function (value, dataIndex) {\n        range[0] <= value && value <= range[1] && dataIndices.push(dataIndex);\n      }, this);\n      result.push({\n        seriesId: seriesModel.id,\n        dataIndex: dataIndices\n      });\n    }, this);\n    return result;\n  },\n\n  /**\r\n   * @implement\r\n   */\n  getVisualMeta: function getVisualMeta(getColorVisual) {\n    var oVals = getColorStopValues(this, 'outOfRange', this.getExtent());\n    var iVals = getColorStopValues(this, 'inRange', this.option.range.slice());\n    var stops = [];\n\n    function setStop(value, valueState) {\n      stops.push({\n        value: value,\n        color: getColorVisual(value, valueState)\n      });\n    } // Format to: outOfRange -- inRange -- outOfRange.\n\n\n    var iIdx = 0;\n    var oIdx = 0;\n    var iLen = iVals.length;\n    var oLen = oVals.length;\n\n    for (; oIdx < oLen && (!iVals.length || oVals[oIdx] <= iVals[0]); oIdx++) {\n      // If oVal[oIdx] === iVals[iIdx], oVal[oIdx] should be ignored.\n      if (oVals[oIdx] < iVals[iIdx]) {\n        setStop(oVals[oIdx], 'outOfRange');\n      }\n    }\n\n    for (var first = 1; iIdx < iLen; iIdx++, first = 0) {\n      // If range is full, value beyond min, max will be clamped.\n      // make a singularity\n      first && stops.length && setStop(iVals[iIdx], 'outOfRange');\n      setStop(iVals[iIdx], 'inRange');\n    }\n\n    for (var first = 1; oIdx < oLen; oIdx++) {\n      if (!iVals.length || iVals[iVals.length - 1] < oVals[oIdx]) {\n        // make a singularity\n        if (first) {\n          stops.length && setStop(stops[stops.length - 1].value, 'outOfRange');\n          first = 0;\n        }\n\n        setStop(oVals[oIdx], 'outOfRange');\n      }\n    }\n\n    var stopsLen = stops.length;\n    return {\n      stops: stops,\n      outerColors: [stopsLen ? stops[0].color : 'transparent', stopsLen ? stops[stopsLen - 1].color : 'transparent']\n    };\n  }\n});\n\nfunction getColorStopValues(visualMapModel, valueState, dataExtent) {\n  if (dataExtent[0] === dataExtent[1]) {\n    return dataExtent.slice();\n  } // When using colorHue mapping, it is not linear color any more.\n  // Moreover, canvas gradient seems not to be accurate linear.\n  // FIXME\n  // Should be arbitrary value 100? or based on pixel size?\n\n\n  var count = 200;\n  var step = (dataExtent[1] - dataExtent[0]) / count;\n  var value = dataExtent[0];\n  var stopValues = [];\n\n  for (var i = 0; i <= count && value < dataExtent[1]; i++) {\n    stopValues.push(value);\n    value += step;\n  }\n\n  stopValues.push(dataExtent[1]);\n  return stopValues;\n}\n\nvar _default = ContinuousModel;\nmodule.exports = _default;","map":{"version":3,"sources":["C:/Users/user/Desktop/Admin/node_modules/echarts/lib/component/visualMap/ContinuousModel.js"],"names":["zrUtil","require","VisualMapModel","numberUtil","DEFAULT_BAR_BOUND","ContinuousModel","extend","type","defaultOption","align","calculable","range","realtime","itemHeight","itemWidth","hoverLink","hoverLinkDataSize","hoverLinkOnHandle","optionUpdated","newOption","isInit","superApply","arguments","resetExtent","resetVisual","mappingOption","mappingMethod","dataExtent","getExtent","_resetRange","resetItemSize","itemSize","_orient","reverse","isNaN","option","auto","isArray","Math","max","min","completeVisualOption","prototype","apply","each","stateList","state","symbolSize","controller","setSelected","selected","slice","getSelected","dataInterval","asc","get","getValueState","value","findTargetDataIndices","result","eachTargetSeries","seriesModel","dataIndices","data","getData","getDataDimension","dataIndex","push","seriesId","id","getVisualMeta","getColorVisual","oVals","getColorStopValues","iVals","stops","setStop","valueState","color","iIdx","oIdx","iLen","length","oLen","first","stopsLen","outerColors","visualMapModel","count","step","stopValues","i","_default","module","exports"],"mappings":"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","sourcesContent":["\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n\r\nvar zrUtil = require(\"zrender/lib/core/util\");\r\n\r\nvar VisualMapModel = require(\"./VisualMapModel\");\r\n\r\nvar numberUtil = require(\"../../util/number\");\r\n\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n// Constant\r\nvar DEFAULT_BAR_BOUND = [20, 140];\r\nvar ContinuousModel = VisualMapModel.extend({\r\n  type: 'visualMap.continuous',\r\n\r\n  /**\r\n   * @protected\r\n   */\r\n  defaultOption: {\r\n    align: 'auto',\r\n    // 'auto', 'left', 'right', 'top', 'bottom'\r\n    calculable: false,\r\n    // This prop effect default component type determine,\r\n    // See echarts/component/visualMap/typeDefaulter.\r\n    range: null,\r\n    // selected range. In default case `range` is [min, max]\r\n    // and can auto change along with modification of min max,\r\n    // util use specifid a range.\r\n    realtime: true,\r\n    // Whether realtime update.\r\n    itemHeight: null,\r\n    // The length of the range control edge.\r\n    itemWidth: null,\r\n    // The length of the other side.\r\n    hoverLink: true,\r\n    // Enable hover highlight.\r\n    hoverLinkDataSize: null,\r\n    // The size of hovered data.\r\n    hoverLinkOnHandle: null // Whether trigger hoverLink when hover handle.\r\n    // If not specified, follow the value of `realtime`.\r\n\r\n  },\r\n\r\n  /**\r\n   * @override\r\n   */\r\n  optionUpdated: function (newOption, isInit) {\r\n    ContinuousModel.superApply(this, 'optionUpdated', arguments);\r\n    this.resetExtent();\r\n    this.resetVisual(function (mappingOption) {\r\n      mappingOption.mappingMethod = 'linear';\r\n      mappingOption.dataExtent = this.getExtent();\r\n    });\r\n\r\n    this._resetRange();\r\n  },\r\n\r\n  /**\r\n   * @protected\r\n   * @override\r\n   */\r\n  resetItemSize: function () {\r\n    ContinuousModel.superApply(this, 'resetItemSize', arguments);\r\n    var itemSize = this.itemSize;\r\n    this._orient === 'horizontal' && itemSize.reverse();\r\n    (itemSize[0] == null || isNaN(itemSize[0])) && (itemSize[0] = DEFAULT_BAR_BOUND[0]);\r\n    (itemSize[1] == null || isNaN(itemSize[1])) && (itemSize[1] = DEFAULT_BAR_BOUND[1]);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _resetRange: function () {\r\n    var dataExtent = this.getExtent();\r\n    var range = this.option.range;\r\n\r\n    if (!range || range.auto) {\r\n      // `range` should always be array (so we dont use other\r\n      // value like 'auto') for user-friend. (consider getOption).\r\n      dataExtent.auto = 1;\r\n      this.option.range = dataExtent;\r\n    } else if (zrUtil.isArray(range)) {\r\n      if (range[0] > range[1]) {\r\n        range.reverse();\r\n      }\r\n\r\n      range[0] = Math.max(range[0], dataExtent[0]);\r\n      range[1] = Math.min(range[1], dataExtent[1]);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @protected\r\n   * @override\r\n   */\r\n  completeVisualOption: function () {\r\n    VisualMapModel.prototype.completeVisualOption.apply(this, arguments);\r\n    zrUtil.each(this.stateList, function (state) {\r\n      var symbolSize = this.option.controller[state].symbolSize;\r\n\r\n      if (symbolSize && symbolSize[0] !== symbolSize[1]) {\r\n        symbolSize[0] = 0; // For good looking.\r\n      }\r\n    }, this);\r\n  },\r\n\r\n  /**\r\n   * @override\r\n   */\r\n  setSelected: function (selected) {\r\n    this.option.range = selected.slice();\r\n\r\n    this._resetRange();\r\n  },\r\n\r\n  /**\r\n   * @public\r\n   */\r\n  getSelected: function () {\r\n    var dataExtent = this.getExtent();\r\n    var dataInterval = numberUtil.asc((this.get('range') || []).slice()); // Clamp\r\n\r\n    dataInterval[0] > dataExtent[1] && (dataInterval[0] = dataExtent[1]);\r\n    dataInterval[1] > dataExtent[1] && (dataInterval[1] = dataExtent[1]);\r\n    dataInterval[0] < dataExtent[0] && (dataInterval[0] = dataExtent[0]);\r\n    dataInterval[1] < dataExtent[0] && (dataInterval[1] = dataExtent[0]);\r\n    return dataInterval;\r\n  },\r\n\r\n  /**\r\n   * @override\r\n   */\r\n  getValueState: function (value) {\r\n    var range = this.option.range;\r\n    var dataExtent = this.getExtent(); // When range[0] === dataExtent[0], any value larger than dataExtent[0] maps to 'inRange'.\r\n    // range[1] is processed likewise.\r\n\r\n    return (range[0] <= dataExtent[0] || range[0] <= value) && (range[1] >= dataExtent[1] || value <= range[1]) ? 'inRange' : 'outOfRange';\r\n  },\r\n\r\n  /**\r\n   * @params {Array.<number>} range target value: range[0] <= value && value <= range[1]\r\n   * @return {Array.<Object>} [{seriesId, dataIndices: <Array.<number>>}, ...]\r\n   */\r\n  findTargetDataIndices: function (range) {\r\n    var result = [];\r\n    this.eachTargetSeries(function (seriesModel) {\r\n      var dataIndices = [];\r\n      var data = seriesModel.getData();\r\n      data.each(this.getDataDimension(data), function (value, dataIndex) {\r\n        range[0] <= value && value <= range[1] && dataIndices.push(dataIndex);\r\n      }, this);\r\n      result.push({\r\n        seriesId: seriesModel.id,\r\n        dataIndex: dataIndices\r\n      });\r\n    }, this);\r\n    return result;\r\n  },\r\n\r\n  /**\r\n   * @implement\r\n   */\r\n  getVisualMeta: function (getColorVisual) {\r\n    var oVals = getColorStopValues(this, 'outOfRange', this.getExtent());\r\n    var iVals = getColorStopValues(this, 'inRange', this.option.range.slice());\r\n    var stops = [];\r\n\r\n    function setStop(value, valueState) {\r\n      stops.push({\r\n        value: value,\r\n        color: getColorVisual(value, valueState)\r\n      });\r\n    } // Format to: outOfRange -- inRange -- outOfRange.\r\n\r\n\r\n    var iIdx = 0;\r\n    var oIdx = 0;\r\n    var iLen = iVals.length;\r\n    var oLen = oVals.length;\r\n\r\n    for (; oIdx < oLen && (!iVals.length || oVals[oIdx] <= iVals[0]); oIdx++) {\r\n      // If oVal[oIdx] === iVals[iIdx], oVal[oIdx] should be ignored.\r\n      if (oVals[oIdx] < iVals[iIdx]) {\r\n        setStop(oVals[oIdx], 'outOfRange');\r\n      }\r\n    }\r\n\r\n    for (var first = 1; iIdx < iLen; iIdx++, first = 0) {\r\n      // If range is full, value beyond min, max will be clamped.\r\n      // make a singularity\r\n      first && stops.length && setStop(iVals[iIdx], 'outOfRange');\r\n      setStop(iVals[iIdx], 'inRange');\r\n    }\r\n\r\n    for (var first = 1; oIdx < oLen; oIdx++) {\r\n      if (!iVals.length || iVals[iVals.length - 1] < oVals[oIdx]) {\r\n        // make a singularity\r\n        if (first) {\r\n          stops.length && setStop(stops[stops.length - 1].value, 'outOfRange');\r\n          first = 0;\r\n        }\r\n\r\n        setStop(oVals[oIdx], 'outOfRange');\r\n      }\r\n    }\r\n\r\n    var stopsLen = stops.length;\r\n    return {\r\n      stops: stops,\r\n      outerColors: [stopsLen ? stops[0].color : 'transparent', stopsLen ? stops[stopsLen - 1].color : 'transparent']\r\n    };\r\n  }\r\n});\r\n\r\nfunction getColorStopValues(visualMapModel, valueState, dataExtent) {\r\n  if (dataExtent[0] === dataExtent[1]) {\r\n    return dataExtent.slice();\r\n  } // When using colorHue mapping, it is not linear color any more.\r\n  // Moreover, canvas gradient seems not to be accurate linear.\r\n  // FIXME\r\n  // Should be arbitrary value 100? or based on pixel size?\r\n\r\n\r\n  var count = 200;\r\n  var step = (dataExtent[1] - dataExtent[0]) / count;\r\n  var value = dataExtent[0];\r\n  var stopValues = [];\r\n\r\n  for (var i = 0; i <= count && value < dataExtent[1]; i++) {\r\n    stopValues.push(value);\r\n    value += step;\r\n  }\r\n\r\n  stopValues.push(dataExtent[1]);\r\n  return stopValues;\r\n}\r\n\r\nvar _default = ContinuousModel;\r\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}