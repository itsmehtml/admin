{"ast":null,"code":"/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar DataZoomView = require(\"./DataZoomView\");\n\nvar sliderMove = require(\"../helper/sliderMove\");\n\nvar roams = require(\"./roams\");\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\n\n\nvar bind = zrUtil.bind;\nvar InsideZoomView = DataZoomView.extend({\n  type: 'dataZoom.inside',\n\n  /**\r\n   * @override\r\n   */\n  init: function init(ecModel, api) {\n    /**\r\n     * 'throttle' is used in this.dispatchAction, so we save range\r\n     * to avoid missing some 'pan' info.\r\n     * @private\r\n     * @type {Array.<number>}\r\n     */\n    this._range;\n  },\n\n  /**\r\n   * @override\r\n   */\n  render: function render(dataZoomModel, ecModel, api, payload) {\n    InsideZoomView.superApply(this, 'render', arguments); // Hence the `throttle` util ensures to preserve command order,\n    // here simply updating range all the time will not cause missing\n    // any of the the roam change.\n\n    this._range = dataZoomModel.getPercentRange(); // Reset controllers.\n\n    zrUtil.each(this.getTargetCoordInfo(), function (coordInfoList, coordSysName) {\n      var allCoordIds = zrUtil.map(coordInfoList, function (coordInfo) {\n        return roams.generateCoordId(coordInfo.model);\n      });\n      zrUtil.each(coordInfoList, function (coordInfo) {\n        var coordModel = coordInfo.model;\n        var getRange = {};\n        zrUtil.each(['pan', 'zoom', 'scrollMove'], function (eventName) {\n          getRange[eventName] = bind(roamHandlers[eventName], this, coordInfo, coordSysName);\n        }, this);\n        roams.register(api, {\n          coordId: roams.generateCoordId(coordModel),\n          allCoordIds: allCoordIds,\n          containsPoint: function containsPoint(e, x, y) {\n            return coordModel.coordinateSystem.containPoint([x, y]);\n          },\n          dataZoomId: dataZoomModel.id,\n          dataZoomModel: dataZoomModel,\n          getRange: getRange\n        });\n      }, this);\n    }, this);\n  },\n\n  /**\r\n   * @override\r\n   */\n  dispose: function dispose() {\n    roams.unregister(this.api, this.dataZoomModel.id);\n    InsideZoomView.superApply(this, 'dispose', arguments);\n    this._range = null;\n  }\n});\nvar roamHandlers = {\n  /**\r\n   * @this {module:echarts/component/dataZoom/InsideZoomView}\r\n   */\n  zoom: function zoom(coordInfo, coordSysName, controller, e) {\n    var lastRange = this._range;\n    var range = lastRange.slice(); // Calculate transform by the first axis.\n\n    var axisModel = coordInfo.axisModels[0];\n\n    if (!axisModel) {\n      return;\n    }\n\n    var directionInfo = getDirectionInfo[coordSysName](null, [e.originX, e.originY], axisModel, controller, coordInfo);\n    var percentPoint = (directionInfo.signal > 0 ? directionInfo.pixelStart + directionInfo.pixelLength - directionInfo.pixel : directionInfo.pixel - directionInfo.pixelStart) / directionInfo.pixelLength * (range[1] - range[0]) + range[0];\n    var scale = Math.max(1 / e.scale, 0);\n    range[0] = (range[0] - percentPoint) * scale + percentPoint;\n    range[1] = (range[1] - percentPoint) * scale + percentPoint; // Restrict range.\n\n    var minMaxSpan = this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();\n    sliderMove(0, range, [0, 100], 0, minMaxSpan.minSpan, minMaxSpan.maxSpan);\n    this._range = range;\n\n    if (lastRange[0] !== range[0] || lastRange[1] !== range[1]) {\n      return range;\n    }\n  },\n\n  /**\r\n   * @this {module:echarts/component/dataZoom/InsideZoomView}\r\n   */\n  pan: makeMover(function (range, axisModel, coordInfo, coordSysName, controller, e) {\n    var directionInfo = getDirectionInfo[coordSysName]([e.oldX, e.oldY], [e.newX, e.newY], axisModel, controller, coordInfo);\n    return directionInfo.signal * (range[1] - range[0]) * directionInfo.pixel / directionInfo.pixelLength;\n  }),\n\n  /**\r\n   * @this {module:echarts/component/dataZoom/InsideZoomView}\r\n   */\n  scrollMove: makeMover(function (range, axisModel, coordInfo, coordSysName, controller, e) {\n    var directionInfo = getDirectionInfo[coordSysName]([0, 0], [e.scrollDelta, e.scrollDelta], axisModel, controller, coordInfo);\n    return directionInfo.signal * (range[1] - range[0]) * e.scrollDelta;\n  })\n};\n\nfunction makeMover(getPercentDelta) {\n  return function (coordInfo, coordSysName, controller, e) {\n    var lastRange = this._range;\n    var range = lastRange.slice(); // Calculate transform by the first axis.\n\n    var axisModel = coordInfo.axisModels[0];\n\n    if (!axisModel) {\n      return;\n    }\n\n    var percentDelta = getPercentDelta(range, axisModel, coordInfo, coordSysName, controller, e);\n    sliderMove(percentDelta, range, [0, 100], 'all');\n    this._range = range;\n\n    if (lastRange[0] !== range[0] || lastRange[1] !== range[1]) {\n      return range;\n    }\n  };\n}\n\nvar getDirectionInfo = {\n  grid: function grid(oldPoint, newPoint, axisModel, controller, coordInfo) {\n    var axis = axisModel.axis;\n    var ret = {};\n    var rect = coordInfo.model.coordinateSystem.getRect();\n    oldPoint = oldPoint || [0, 0];\n\n    if (axis.dim === 'x') {\n      ret.pixel = newPoint[0] - oldPoint[0];\n      ret.pixelLength = rect.width;\n      ret.pixelStart = rect.x;\n      ret.signal = axis.inverse ? 1 : -1;\n    } else {\n      // axis.dim === 'y'\n      ret.pixel = newPoint[1] - oldPoint[1];\n      ret.pixelLength = rect.height;\n      ret.pixelStart = rect.y;\n      ret.signal = axis.inverse ? -1 : 1;\n    }\n\n    return ret;\n  },\n  polar: function polar(oldPoint, newPoint, axisModel, controller, coordInfo) {\n    var axis = axisModel.axis;\n    var ret = {};\n    var polar = coordInfo.model.coordinateSystem;\n    var radiusExtent = polar.getRadiusAxis().getExtent();\n    var angleExtent = polar.getAngleAxis().getExtent();\n    oldPoint = oldPoint ? polar.pointToCoord(oldPoint) : [0, 0];\n    newPoint = polar.pointToCoord(newPoint);\n\n    if (axisModel.mainType === 'radiusAxis') {\n      ret.pixel = newPoint[0] - oldPoint[0]; // ret.pixelLength = Math.abs(radiusExtent[1] - radiusExtent[0]);\n      // ret.pixelStart = Math.min(radiusExtent[0], radiusExtent[1]);\n\n      ret.pixelLength = radiusExtent[1] - radiusExtent[0];\n      ret.pixelStart = radiusExtent[0];\n      ret.signal = axis.inverse ? 1 : -1;\n    } else {\n      // 'angleAxis'\n      ret.pixel = newPoint[1] - oldPoint[1]; // ret.pixelLength = Math.abs(angleExtent[1] - angleExtent[0]);\n      // ret.pixelStart = Math.min(angleExtent[0], angleExtent[1]);\n\n      ret.pixelLength = angleExtent[1] - angleExtent[0];\n      ret.pixelStart = angleExtent[0];\n      ret.signal = axis.inverse ? -1 : 1;\n    }\n\n    return ret;\n  },\n  singleAxis: function singleAxis(oldPoint, newPoint, axisModel, controller, coordInfo) {\n    var axis = axisModel.axis;\n    var rect = coordInfo.model.coordinateSystem.getRect();\n    var ret = {};\n    oldPoint = oldPoint || [0, 0];\n\n    if (axis.orient === 'horizontal') {\n      ret.pixel = newPoint[0] - oldPoint[0];\n      ret.pixelLength = rect.width;\n      ret.pixelStart = rect.x;\n      ret.signal = axis.inverse ? 1 : -1;\n    } else {\n      // 'vertical'\n      ret.pixel = newPoint[1] - oldPoint[1];\n      ret.pixelLength = rect.height;\n      ret.pixelStart = rect.y;\n      ret.signal = axis.inverse ? -1 : 1;\n    }\n\n    return ret;\n  }\n};\nvar _default = InsideZoomView;\nmodule.exports = _default;","map":{"version":3,"sources":["C:/Users/user/Desktop/Admin/node_modules/echarts/lib/component/dataZoom/InsideZoomView.js"],"names":["zrUtil","require","DataZoomView","sliderMove","roams","bind","InsideZoomView","extend","type","init","ecModel","api","_range","render","dataZoomModel","payload","superApply","arguments","getPercentRange","each","getTargetCoordInfo","coordInfoList","coordSysName","allCoordIds","map","coordInfo","generateCoordId","model","coordModel","getRange","eventName","roamHandlers","register","coordId","containsPoint","e","x","y","coordinateSystem","containPoint","dataZoomId","id","dispose","unregister","zoom","controller","lastRange","range","slice","axisModel","axisModels","directionInfo","getDirectionInfo","originX","originY","percentPoint","signal","pixelStart","pixelLength","pixel","scale","Math","max","minMaxSpan","findRepresentativeAxisProxy","getMinMaxSpan","minSpan","maxSpan","pan","makeMover","oldX","oldY","newX","newY","scrollMove","scrollDelta","getPercentDelta","percentDelta","grid","oldPoint","newPoint","axis","ret","rect","getRect","dim","width","inverse","height","polar","radiusExtent","getRadiusAxis","getExtent","angleExtent","getAngleAxis","pointToCoord","mainType","singleAxis","orient","_default","module","exports"],"mappings":"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","sourcesContent":["\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n\r\nvar zrUtil = require(\"zrender/lib/core/util\");\r\n\r\nvar DataZoomView = require(\"./DataZoomView\");\r\n\r\nvar sliderMove = require(\"../helper/sliderMove\");\r\n\r\nvar roams = require(\"./roams\");\r\n\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\nvar bind = zrUtil.bind;\r\nvar InsideZoomView = DataZoomView.extend({\r\n  type: 'dataZoom.inside',\r\n\r\n  /**\r\n   * @override\r\n   */\r\n  init: function (ecModel, api) {\r\n    /**\r\n     * 'throttle' is used in this.dispatchAction, so we save range\r\n     * to avoid missing some 'pan' info.\r\n     * @private\r\n     * @type {Array.<number>}\r\n     */\r\n    this._range;\r\n  },\r\n\r\n  /**\r\n   * @override\r\n   */\r\n  render: function (dataZoomModel, ecModel, api, payload) {\r\n    InsideZoomView.superApply(this, 'render', arguments); // Hence the `throttle` util ensures to preserve command order,\r\n    // here simply updating range all the time will not cause missing\r\n    // any of the the roam change.\r\n\r\n    this._range = dataZoomModel.getPercentRange(); // Reset controllers.\r\n\r\n    zrUtil.each(this.getTargetCoordInfo(), function (coordInfoList, coordSysName) {\r\n      var allCoordIds = zrUtil.map(coordInfoList, function (coordInfo) {\r\n        return roams.generateCoordId(coordInfo.model);\r\n      });\r\n      zrUtil.each(coordInfoList, function (coordInfo) {\r\n        var coordModel = coordInfo.model;\r\n        var getRange = {};\r\n        zrUtil.each(['pan', 'zoom', 'scrollMove'], function (eventName) {\r\n          getRange[eventName] = bind(roamHandlers[eventName], this, coordInfo, coordSysName);\r\n        }, this);\r\n        roams.register(api, {\r\n          coordId: roams.generateCoordId(coordModel),\r\n          allCoordIds: allCoordIds,\r\n          containsPoint: function (e, x, y) {\r\n            return coordModel.coordinateSystem.containPoint([x, y]);\r\n          },\r\n          dataZoomId: dataZoomModel.id,\r\n          dataZoomModel: dataZoomModel,\r\n          getRange: getRange\r\n        });\r\n      }, this);\r\n    }, this);\r\n  },\r\n\r\n  /**\r\n   * @override\r\n   */\r\n  dispose: function () {\r\n    roams.unregister(this.api, this.dataZoomModel.id);\r\n    InsideZoomView.superApply(this, 'dispose', arguments);\r\n    this._range = null;\r\n  }\r\n});\r\nvar roamHandlers = {\r\n  /**\r\n   * @this {module:echarts/component/dataZoom/InsideZoomView}\r\n   */\r\n  zoom: function (coordInfo, coordSysName, controller, e) {\r\n    var lastRange = this._range;\r\n    var range = lastRange.slice(); // Calculate transform by the first axis.\r\n\r\n    var axisModel = coordInfo.axisModels[0];\r\n\r\n    if (!axisModel) {\r\n      return;\r\n    }\r\n\r\n    var directionInfo = getDirectionInfo[coordSysName](null, [e.originX, e.originY], axisModel, controller, coordInfo);\r\n    var percentPoint = (directionInfo.signal > 0 ? directionInfo.pixelStart + directionInfo.pixelLength - directionInfo.pixel : directionInfo.pixel - directionInfo.pixelStart) / directionInfo.pixelLength * (range[1] - range[0]) + range[0];\r\n    var scale = Math.max(1 / e.scale, 0);\r\n    range[0] = (range[0] - percentPoint) * scale + percentPoint;\r\n    range[1] = (range[1] - percentPoint) * scale + percentPoint; // Restrict range.\r\n\r\n    var minMaxSpan = this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();\r\n    sliderMove(0, range, [0, 100], 0, minMaxSpan.minSpan, minMaxSpan.maxSpan);\r\n    this._range = range;\r\n\r\n    if (lastRange[0] !== range[0] || lastRange[1] !== range[1]) {\r\n      return range;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @this {module:echarts/component/dataZoom/InsideZoomView}\r\n   */\r\n  pan: makeMover(function (range, axisModel, coordInfo, coordSysName, controller, e) {\r\n    var directionInfo = getDirectionInfo[coordSysName]([e.oldX, e.oldY], [e.newX, e.newY], axisModel, controller, coordInfo);\r\n    return directionInfo.signal * (range[1] - range[0]) * directionInfo.pixel / directionInfo.pixelLength;\r\n  }),\r\n\r\n  /**\r\n   * @this {module:echarts/component/dataZoom/InsideZoomView}\r\n   */\r\n  scrollMove: makeMover(function (range, axisModel, coordInfo, coordSysName, controller, e) {\r\n    var directionInfo = getDirectionInfo[coordSysName]([0, 0], [e.scrollDelta, e.scrollDelta], axisModel, controller, coordInfo);\r\n    return directionInfo.signal * (range[1] - range[0]) * e.scrollDelta;\r\n  })\r\n};\r\n\r\nfunction makeMover(getPercentDelta) {\r\n  return function (coordInfo, coordSysName, controller, e) {\r\n    var lastRange = this._range;\r\n    var range = lastRange.slice(); // Calculate transform by the first axis.\r\n\r\n    var axisModel = coordInfo.axisModels[0];\r\n\r\n    if (!axisModel) {\r\n      return;\r\n    }\r\n\r\n    var percentDelta = getPercentDelta(range, axisModel, coordInfo, coordSysName, controller, e);\r\n    sliderMove(percentDelta, range, [0, 100], 'all');\r\n    this._range = range;\r\n\r\n    if (lastRange[0] !== range[0] || lastRange[1] !== range[1]) {\r\n      return range;\r\n    }\r\n  };\r\n}\r\n\r\nvar getDirectionInfo = {\r\n  grid: function (oldPoint, newPoint, axisModel, controller, coordInfo) {\r\n    var axis = axisModel.axis;\r\n    var ret = {};\r\n    var rect = coordInfo.model.coordinateSystem.getRect();\r\n    oldPoint = oldPoint || [0, 0];\r\n\r\n    if (axis.dim === 'x') {\r\n      ret.pixel = newPoint[0] - oldPoint[0];\r\n      ret.pixelLength = rect.width;\r\n      ret.pixelStart = rect.x;\r\n      ret.signal = axis.inverse ? 1 : -1;\r\n    } else {\r\n      // axis.dim === 'y'\r\n      ret.pixel = newPoint[1] - oldPoint[1];\r\n      ret.pixelLength = rect.height;\r\n      ret.pixelStart = rect.y;\r\n      ret.signal = axis.inverse ? -1 : 1;\r\n    }\r\n\r\n    return ret;\r\n  },\r\n  polar: function (oldPoint, newPoint, axisModel, controller, coordInfo) {\r\n    var axis = axisModel.axis;\r\n    var ret = {};\r\n    var polar = coordInfo.model.coordinateSystem;\r\n    var radiusExtent = polar.getRadiusAxis().getExtent();\r\n    var angleExtent = polar.getAngleAxis().getExtent();\r\n    oldPoint = oldPoint ? polar.pointToCoord(oldPoint) : [0, 0];\r\n    newPoint = polar.pointToCoord(newPoint);\r\n\r\n    if (axisModel.mainType === 'radiusAxis') {\r\n      ret.pixel = newPoint[0] - oldPoint[0]; // ret.pixelLength = Math.abs(radiusExtent[1] - radiusExtent[0]);\r\n      // ret.pixelStart = Math.min(radiusExtent[0], radiusExtent[1]);\r\n\r\n      ret.pixelLength = radiusExtent[1] - radiusExtent[0];\r\n      ret.pixelStart = radiusExtent[0];\r\n      ret.signal = axis.inverse ? 1 : -1;\r\n    } else {\r\n      // 'angleAxis'\r\n      ret.pixel = newPoint[1] - oldPoint[1]; // ret.pixelLength = Math.abs(angleExtent[1] - angleExtent[0]);\r\n      // ret.pixelStart = Math.min(angleExtent[0], angleExtent[1]);\r\n\r\n      ret.pixelLength = angleExtent[1] - angleExtent[0];\r\n      ret.pixelStart = angleExtent[0];\r\n      ret.signal = axis.inverse ? -1 : 1;\r\n    }\r\n\r\n    return ret;\r\n  },\r\n  singleAxis: function (oldPoint, newPoint, axisModel, controller, coordInfo) {\r\n    var axis = axisModel.axis;\r\n    var rect = coordInfo.model.coordinateSystem.getRect();\r\n    var ret = {};\r\n    oldPoint = oldPoint || [0, 0];\r\n\r\n    if (axis.orient === 'horizontal') {\r\n      ret.pixel = newPoint[0] - oldPoint[0];\r\n      ret.pixelLength = rect.width;\r\n      ret.pixelStart = rect.x;\r\n      ret.signal = axis.inverse ? 1 : -1;\r\n    } else {\r\n      // 'vertical'\r\n      ret.pixel = newPoint[1] - oldPoint[1];\r\n      ret.pixelLength = rect.height;\r\n      ret.pixelStart = rect.y;\r\n      ret.signal = axis.inverse ? -1 : 1;\r\n    }\r\n\r\n    return ret;\r\n  }\r\n};\r\nvar _default = InsideZoomView;\r\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}