{"ast":null,"code":"var Definable = require(\"./Definable\");\n\nvar zrUtil = require(\"../../core/util\");\n\nvar logError = require(\"../../core/log\");\n\nvar colorTool = require(\"../../tool/color\");\n/**\r\n * @file Manages SVG gradient elements.\r\n * @author Zhang Wenli\r\n */\n\n/**\r\n * Manages SVG gradient elements.\r\n *\r\n * @class\r\n * @extends Definable\r\n * @param   {number}     zrId    zrender instance id\r\n * @param   {SVGElement} svgRoot root of SVG document\r\n */\n\n\nfunction GradientManager(zrId, svgRoot) {\n  Definable.call(this, zrId, svgRoot, ['linearGradient', 'radialGradient'], '__gradient_in_use__');\n}\n\nzrUtil.inherits(GradientManager, Definable);\n/**\r\n * Create new gradient DOM for fill or stroke if not exist,\r\n * but will not update gradient if exists.\r\n *\r\n * @param {SvgElement}  svgElement   SVG element to paint\r\n * @param {Displayable} displayable  zrender displayable element\r\n */\n\nGradientManager.prototype.addWithoutUpdate = function (svgElement, displayable) {\n  if (displayable && displayable.style) {\n    var that = this;\n    zrUtil.each(['fill', 'stroke'], function (fillOrStroke) {\n      if (displayable.style[fillOrStroke] && (displayable.style[fillOrStroke].type === 'linear' || displayable.style[fillOrStroke].type === 'radial')) {\n        var gradient = displayable.style[fillOrStroke];\n        var defs = that.getDefs(true); // Create dom in <defs> if not exists\n\n        var dom;\n\n        if (gradient._dom) {\n          // Gradient exists\n          dom = gradient._dom;\n\n          if (!defs.contains(gradient._dom)) {\n            // _dom is no longer in defs, recreate\n            that.addDom(dom);\n          }\n        } else {\n          // New dom\n          dom = that.add(gradient);\n        }\n\n        that.markUsed(displayable);\n        var id = dom.getAttribute('id');\n        svgElement.setAttribute(fillOrStroke, 'url(#' + id + ')');\n      }\n    });\n  }\n};\n/**\r\n * Add a new gradient tag in <defs>\r\n *\r\n * @param   {Gradient} gradient zr gradient instance\r\n * @return {SVGLinearGradientElement | SVGRadialGradientElement}\r\n *                            created DOM\r\n */\n\n\nGradientManager.prototype.add = function (gradient) {\n  var dom;\n\n  if (gradient.type === 'linear') {\n    dom = this.createElement('linearGradient');\n  } else if (gradient.type === 'radial') {\n    dom = this.createElement('radialGradient');\n  } else {\n    logError('Illegal gradient type.');\n    return null;\n  } // Set dom id with gradient id, since each gradient instance\n  // will have no more than one dom element.\n  // id may exists before for those dirty elements, in which case\n  // id should remain the same, and other attributes should be\n  // updated.\n\n\n  gradient.id = gradient.id || this.nextId++;\n  dom.setAttribute('id', 'zr' + this._zrId + '-gradient-' + gradient.id);\n  this.updateDom(gradient, dom);\n  this.addDom(dom);\n  return dom;\n};\n/**\r\n * Update gradient.\r\n *\r\n * @param {Gradient} gradient zr gradient instance\r\n */\n\n\nGradientManager.prototype.update = function (gradient) {\n  var that = this;\n  Definable.prototype.update.call(this, gradient, function () {\n    var type = gradient.type;\n    var tagName = gradient._dom.tagName;\n\n    if (type === 'linear' && tagName === 'linearGradient' || type === 'radial' && tagName === 'radialGradient') {\n      // Gradient type is not changed, update gradient\n      that.updateDom(gradient, gradient._dom);\n    } else {\n      // Remove and re-create if type is changed\n      that.removeDom(gradient);\n      that.add(gradient);\n    }\n  });\n};\n/**\r\n * Update gradient dom\r\n *\r\n * @param {Gradient} gradient zr gradient instance\r\n * @param {SVGLinearGradientElement | SVGRadialGradientElement} dom\r\n *                            DOM to update\r\n */\n\n\nGradientManager.prototype.updateDom = function (gradient, dom) {\n  if (gradient.type === 'linear') {\n    dom.setAttribute('x1', gradient.x);\n    dom.setAttribute('y1', gradient.y);\n    dom.setAttribute('x2', gradient.x2);\n    dom.setAttribute('y2', gradient.y2);\n  } else if (gradient.type === 'radial') {\n    dom.setAttribute('cx', gradient.x);\n    dom.setAttribute('cy', gradient.y);\n    dom.setAttribute('r', gradient.r);\n  } else {\n    logError('Illegal gradient type.');\n    return;\n  }\n\n  if (gradient.global) {\n    // x1, x2, y1, y2 in range of 0 to canvas width or height\n    dom.setAttribute('gradientUnits', 'userSpaceOnUse');\n  } else {\n    // x1, x2, y1, y2 in range of 0 to 1\n    dom.setAttribute('gradientUnits', 'objectBoundingBox');\n  } // Remove color stops if exists\n\n\n  dom.innerHTML = ''; // Add color stops\n\n  var colors = gradient.colorStops;\n\n  for (var i = 0, len = colors.length; i < len; ++i) {\n    var stop = this.createElement('stop');\n    stop.setAttribute('offset', colors[i].offset * 100 + '%');\n    var color = colors[i].color;\n\n    if (color.indexOf('rgba' > -1)) {\n      // Fix Safari bug that stop-color not recognizing alpha #9014\n      var opacity = colorTool.parse(color)[3];\n      var hex = colorTool.toHex(color); // stop-color cannot be color, since:\n      // The opacity value used for the gradient calculation is the\n      // *product* of the value of stop-opacity and the opacity of the\n      // value of stop-color.\n      // See https://www.w3.org/TR/SVG2/pservers.html#StopOpacityProperty\n\n      stop.setAttribute('stop-color', '#' + hex);\n      stop.setAttribute('stop-opacity', opacity);\n    } else {\n      stop.setAttribute('stop-color', colors[i].color);\n    }\n\n    dom.appendChild(stop);\n  } // Store dom element in gradient, to avoid creating multiple\n  // dom instances for the same gradient element\n\n\n  gradient._dom = dom;\n};\n/**\r\n * Mark a single gradient to be used\r\n *\r\n * @param {Displayable} displayable displayable element\r\n */\n\n\nGradientManager.prototype.markUsed = function (displayable) {\n  if (displayable.style) {\n    var gradient = displayable.style.fill;\n\n    if (gradient && gradient._dom) {\n      Definable.prototype.markUsed.call(this, gradient._dom);\n    }\n\n    gradient = displayable.style.stroke;\n\n    if (gradient && gradient._dom) {\n      Definable.prototype.markUsed.call(this, gradient._dom);\n    }\n  }\n};\n\nvar _default = GradientManager;\nmodule.exports = _default;","map":{"version":3,"sources":["C:/Users/user/Desktop/Admin/node_modules/zrender/lib/svg/helper/GradientManager.js"],"names":["Definable","require","zrUtil","logError","colorTool","GradientManager","zrId","svgRoot","call","inherits","prototype","addWithoutUpdate","svgElement","displayable","style","that","each","fillOrStroke","type","gradient","defs","getDefs","dom","_dom","contains","addDom","add","markUsed","id","getAttribute","setAttribute","createElement","nextId","_zrId","updateDom","update","tagName","removeDom","x","y","x2","y2","r","global","innerHTML","colors","colorStops","i","len","length","stop","offset","color","indexOf","opacity","parse","hex","toHex","appendChild","fill","stroke","_default","module","exports"],"mappings":"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","sourcesContent":["var Definable = require(\"./Definable\");\r\n\r\nvar zrUtil = require(\"../../core/util\");\r\n\r\nvar logError = require(\"../../core/log\");\r\n\r\nvar colorTool = require(\"../../tool/color\");\r\n\r\n/**\r\n * @file Manages SVG gradient elements.\r\n * @author Zhang Wenli\r\n */\r\n\r\n/**\r\n * Manages SVG gradient elements.\r\n *\r\n * @class\r\n * @extends Definable\r\n * @param   {number}     zrId    zrender instance id\r\n * @param   {SVGElement} svgRoot root of SVG document\r\n */\r\nfunction GradientManager(zrId, svgRoot) {\r\n  Definable.call(this, zrId, svgRoot, ['linearGradient', 'radialGradient'], '__gradient_in_use__');\r\n}\r\n\r\nzrUtil.inherits(GradientManager, Definable);\r\n/**\r\n * Create new gradient DOM for fill or stroke if not exist,\r\n * but will not update gradient if exists.\r\n *\r\n * @param {SvgElement}  svgElement   SVG element to paint\r\n * @param {Displayable} displayable  zrender displayable element\r\n */\r\n\r\nGradientManager.prototype.addWithoutUpdate = function (svgElement, displayable) {\r\n  if (displayable && displayable.style) {\r\n    var that = this;\r\n    zrUtil.each(['fill', 'stroke'], function (fillOrStroke) {\r\n      if (displayable.style[fillOrStroke] && (displayable.style[fillOrStroke].type === 'linear' || displayable.style[fillOrStroke].type === 'radial')) {\r\n        var gradient = displayable.style[fillOrStroke];\r\n        var defs = that.getDefs(true); // Create dom in <defs> if not exists\r\n\r\n        var dom;\r\n\r\n        if (gradient._dom) {\r\n          // Gradient exists\r\n          dom = gradient._dom;\r\n\r\n          if (!defs.contains(gradient._dom)) {\r\n            // _dom is no longer in defs, recreate\r\n            that.addDom(dom);\r\n          }\r\n        } else {\r\n          // New dom\r\n          dom = that.add(gradient);\r\n        }\r\n\r\n        that.markUsed(displayable);\r\n        var id = dom.getAttribute('id');\r\n        svgElement.setAttribute(fillOrStroke, 'url(#' + id + ')');\r\n      }\r\n    });\r\n  }\r\n};\r\n/**\r\n * Add a new gradient tag in <defs>\r\n *\r\n * @param   {Gradient} gradient zr gradient instance\r\n * @return {SVGLinearGradientElement | SVGRadialGradientElement}\r\n *                            created DOM\r\n */\r\n\r\n\r\nGradientManager.prototype.add = function (gradient) {\r\n  var dom;\r\n\r\n  if (gradient.type === 'linear') {\r\n    dom = this.createElement('linearGradient');\r\n  } else if (gradient.type === 'radial') {\r\n    dom = this.createElement('radialGradient');\r\n  } else {\r\n    logError('Illegal gradient type.');\r\n    return null;\r\n  } // Set dom id with gradient id, since each gradient instance\r\n  // will have no more than one dom element.\r\n  // id may exists before for those dirty elements, in which case\r\n  // id should remain the same, and other attributes should be\r\n  // updated.\r\n\r\n\r\n  gradient.id = gradient.id || this.nextId++;\r\n  dom.setAttribute('id', 'zr' + this._zrId + '-gradient-' + gradient.id);\r\n  this.updateDom(gradient, dom);\r\n  this.addDom(dom);\r\n  return dom;\r\n};\r\n/**\r\n * Update gradient.\r\n *\r\n * @param {Gradient} gradient zr gradient instance\r\n */\r\n\r\n\r\nGradientManager.prototype.update = function (gradient) {\r\n  var that = this;\r\n  Definable.prototype.update.call(this, gradient, function () {\r\n    var type = gradient.type;\r\n    var tagName = gradient._dom.tagName;\r\n\r\n    if (type === 'linear' && tagName === 'linearGradient' || type === 'radial' && tagName === 'radialGradient') {\r\n      // Gradient type is not changed, update gradient\r\n      that.updateDom(gradient, gradient._dom);\r\n    } else {\r\n      // Remove and re-create if type is changed\r\n      that.removeDom(gradient);\r\n      that.add(gradient);\r\n    }\r\n  });\r\n};\r\n/**\r\n * Update gradient dom\r\n *\r\n * @param {Gradient} gradient zr gradient instance\r\n * @param {SVGLinearGradientElement | SVGRadialGradientElement} dom\r\n *                            DOM to update\r\n */\r\n\r\n\r\nGradientManager.prototype.updateDom = function (gradient, dom) {\r\n  if (gradient.type === 'linear') {\r\n    dom.setAttribute('x1', gradient.x);\r\n    dom.setAttribute('y1', gradient.y);\r\n    dom.setAttribute('x2', gradient.x2);\r\n    dom.setAttribute('y2', gradient.y2);\r\n  } else if (gradient.type === 'radial') {\r\n    dom.setAttribute('cx', gradient.x);\r\n    dom.setAttribute('cy', gradient.y);\r\n    dom.setAttribute('r', gradient.r);\r\n  } else {\r\n    logError('Illegal gradient type.');\r\n    return;\r\n  }\r\n\r\n  if (gradient.global) {\r\n    // x1, x2, y1, y2 in range of 0 to canvas width or height\r\n    dom.setAttribute('gradientUnits', 'userSpaceOnUse');\r\n  } else {\r\n    // x1, x2, y1, y2 in range of 0 to 1\r\n    dom.setAttribute('gradientUnits', 'objectBoundingBox');\r\n  } // Remove color stops if exists\r\n\r\n\r\n  dom.innerHTML = ''; // Add color stops\r\n\r\n  var colors = gradient.colorStops;\r\n\r\n  for (var i = 0, len = colors.length; i < len; ++i) {\r\n    var stop = this.createElement('stop');\r\n    stop.setAttribute('offset', colors[i].offset * 100 + '%');\r\n    var color = colors[i].color;\r\n\r\n    if (color.indexOf('rgba' > -1)) {\r\n      // Fix Safari bug that stop-color not recognizing alpha #9014\r\n      var opacity = colorTool.parse(color)[3];\r\n      var hex = colorTool.toHex(color); // stop-color cannot be color, since:\r\n      // The opacity value used for the gradient calculation is the\r\n      // *product* of the value of stop-opacity and the opacity of the\r\n      // value of stop-color.\r\n      // See https://www.w3.org/TR/SVG2/pservers.html#StopOpacityProperty\r\n\r\n      stop.setAttribute('stop-color', '#' + hex);\r\n      stop.setAttribute('stop-opacity', opacity);\r\n    } else {\r\n      stop.setAttribute('stop-color', colors[i].color);\r\n    }\r\n\r\n    dom.appendChild(stop);\r\n  } // Store dom element in gradient, to avoid creating multiple\r\n  // dom instances for the same gradient element\r\n\r\n\r\n  gradient._dom = dom;\r\n};\r\n/**\r\n * Mark a single gradient to be used\r\n *\r\n * @param {Displayable} displayable displayable element\r\n */\r\n\r\n\r\nGradientManager.prototype.markUsed = function (displayable) {\r\n  if (displayable.style) {\r\n    var gradient = displayable.style.fill;\r\n\r\n    if (gradient && gradient._dom) {\r\n      Definable.prototype.markUsed.call(this, gradient._dom);\r\n    }\r\n\r\n    gradient = displayable.style.stroke;\r\n\r\n    if (gradient && gradient._dom) {\r\n      Definable.prototype.markUsed.call(this, gradient._dom);\r\n    }\r\n  }\r\n};\r\n\r\nvar _default = GradientManager;\r\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}