{"ast":null,"code":"/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nvar _helper = require(\"./helper\");\n\nvar prepareDataCoordInfo = _helper.prepareDataCoordInfo;\nvar getStackedOnPoint = _helper.getStackedOnPoint;\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\n// var arrayDiff = require('zrender/src/core/arrayDiff');\n// 'zrender/src/core/arrayDiff' has been used before, but it did\n// not do well in performance when roam with fixed dataZoom window.\n// function convertToIntId(newIdList, oldIdList) {\n//     // Generate int id instead of string id.\n//     // Compare string maybe slow in score function of arrDiff\n//     // Assume id in idList are all unique\n//     var idIndicesMap = {};\n//     var idx = 0;\n//     for (var i = 0; i < newIdList.length; i++) {\n//         idIndicesMap[newIdList[i]] = idx;\n//         newIdList[i] = idx++;\n//     }\n//     for (var i = 0; i < oldIdList.length; i++) {\n//         var oldId = oldIdList[i];\n//         // Same with newIdList\n//         if (idIndicesMap[oldId]) {\n//             oldIdList[i] = idIndicesMap[oldId];\n//         }\n//         else {\n//             oldIdList[i] = idx++;\n//         }\n//     }\n// }\n\nfunction diffData(oldData, newData) {\n  var diffResult = [];\n  newData.diff(oldData).add(function (idx) {\n    diffResult.push({\n      cmd: '+',\n      idx: idx\n    });\n  }).update(function (newIdx, oldIdx) {\n    diffResult.push({\n      cmd: '=',\n      idx: oldIdx,\n      idx1: newIdx\n    });\n  }).remove(function (idx) {\n    diffResult.push({\n      cmd: '-',\n      idx: idx\n    });\n  }).execute();\n  return diffResult;\n}\n\nfunction _default(oldData, newData, oldStackedOnPoints, newStackedOnPoints, oldCoordSys, newCoordSys, oldValueOrigin, newValueOrigin) {\n  var diff = diffData(oldData, newData); // var newIdList = newData.mapArray(newData.getId);\n  // var oldIdList = oldData.mapArray(oldData.getId);\n  // convertToIntId(newIdList, oldIdList);\n  // // FIXME One data ?\n  // diff = arrayDiff(oldIdList, newIdList);\n\n  var currPoints = [];\n  var nextPoints = []; // Points for stacking base line\n\n  var currStackedPoints = [];\n  var nextStackedPoints = [];\n  var status = [];\n  var sortedIndices = [];\n  var rawIndices = [];\n  var newDataOldCoordInfo = prepareDataCoordInfo(oldCoordSys, newData, oldValueOrigin);\n  var oldDataNewCoordInfo = prepareDataCoordInfo(newCoordSys, oldData, newValueOrigin);\n\n  for (var i = 0; i < diff.length; i++) {\n    var diffItem = diff[i];\n    var pointAdded = true; // FIXME, animation is not so perfect when dataZoom window moves fast\n    // Which is in case remvoing or add more than one data in the tail or head\n\n    switch (diffItem.cmd) {\n      case '=':\n        var currentPt = oldData.getItemLayout(diffItem.idx);\n        var nextPt = newData.getItemLayout(diffItem.idx1); // If previous data is NaN, use next point directly\n\n        if (isNaN(currentPt[0]) || isNaN(currentPt[1])) {\n          currentPt = nextPt.slice();\n        }\n\n        currPoints.push(currentPt);\n        nextPoints.push(nextPt);\n        currStackedPoints.push(oldStackedOnPoints[diffItem.idx]);\n        nextStackedPoints.push(newStackedOnPoints[diffItem.idx1]);\n        rawIndices.push(newData.getRawIndex(diffItem.idx1));\n        break;\n\n      case '+':\n        var idx = diffItem.idx;\n        currPoints.push(oldCoordSys.dataToPoint([newData.get(newDataOldCoordInfo.dataDimsForPoint[0], idx), newData.get(newDataOldCoordInfo.dataDimsForPoint[1], idx)]));\n        nextPoints.push(newData.getItemLayout(idx).slice());\n        currStackedPoints.push(getStackedOnPoint(newDataOldCoordInfo, oldCoordSys, newData, idx));\n        nextStackedPoints.push(newStackedOnPoints[idx]);\n        rawIndices.push(newData.getRawIndex(idx));\n        break;\n\n      case '-':\n        var idx = diffItem.idx;\n        var rawIndex = oldData.getRawIndex(idx); // Data is replaced. In the case of dynamic data queue\n        // FIXME FIXME FIXME\n\n        if (rawIndex !== idx) {\n          currPoints.push(oldData.getItemLayout(idx));\n          nextPoints.push(newCoordSys.dataToPoint([oldData.get(oldDataNewCoordInfo.dataDimsForPoint[0], idx), oldData.get(oldDataNewCoordInfo.dataDimsForPoint[1], idx)]));\n          currStackedPoints.push(oldStackedOnPoints[idx]);\n          nextStackedPoints.push(getStackedOnPoint(oldDataNewCoordInfo, newCoordSys, oldData, idx));\n          rawIndices.push(rawIndex);\n        } else {\n          pointAdded = false;\n        }\n\n    } // Original indices\n\n\n    if (pointAdded) {\n      status.push(diffItem);\n      sortedIndices.push(sortedIndices.length);\n    }\n  } // Diff result may be crossed if all items are changed\n  // Sort by data index\n\n\n  sortedIndices.sort(function (a, b) {\n    return rawIndices[a] - rawIndices[b];\n  });\n  var sortedCurrPoints = [];\n  var sortedNextPoints = [];\n  var sortedCurrStackedPoints = [];\n  var sortedNextStackedPoints = [];\n  var sortedStatus = [];\n\n  for (var i = 0; i < sortedIndices.length; i++) {\n    var idx = sortedIndices[i];\n    sortedCurrPoints[i] = currPoints[idx];\n    sortedNextPoints[i] = nextPoints[idx];\n    sortedCurrStackedPoints[i] = currStackedPoints[idx];\n    sortedNextStackedPoints[i] = nextStackedPoints[idx];\n    sortedStatus[i] = status[idx];\n  }\n\n  return {\n    current: sortedCurrPoints,\n    next: sortedNextPoints,\n    stackedOnCurrent: sortedCurrStackedPoints,\n    stackedOnNext: sortedNextStackedPoints,\n    status: sortedStatus\n  };\n}\n\nmodule.exports = _default;","map":{"version":3,"sources":["C:/Users/user/Desktop/Admin/node_modules/echarts/lib/chart/line/lineAnimationDiff.js"],"names":["_helper","require","prepareDataCoordInfo","getStackedOnPoint","diffData","oldData","newData","diffResult","diff","add","idx","push","cmd","update","newIdx","oldIdx","idx1","remove","execute","_default","oldStackedOnPoints","newStackedOnPoints","oldCoordSys","newCoordSys","oldValueOrigin","newValueOrigin","currPoints","nextPoints","currStackedPoints","nextStackedPoints","status","sortedIndices","rawIndices","newDataOldCoordInfo","oldDataNewCoordInfo","i","length","diffItem","pointAdded","currentPt","getItemLayout","nextPt","isNaN","slice","getRawIndex","dataToPoint","get","dataDimsForPoint","rawIndex","sort","a","b","sortedCurrPoints","sortedNextPoints","sortedCurrStackedPoints","sortedNextStackedPoints","sortedStatus","current","next","stackedOnCurrent","stackedOnNext","module","exports"],"mappings":"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","sourcesContent":["\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n\r\nvar _helper = require(\"./helper\");\r\n\r\nvar prepareDataCoordInfo = _helper.prepareDataCoordInfo;\r\nvar getStackedOnPoint = _helper.getStackedOnPoint;\r\n\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n// var arrayDiff = require('zrender/src/core/arrayDiff');\r\n// 'zrender/src/core/arrayDiff' has been used before, but it did\r\n// not do well in performance when roam with fixed dataZoom window.\r\n// function convertToIntId(newIdList, oldIdList) {\r\n//     // Generate int id instead of string id.\r\n//     // Compare string maybe slow in score function of arrDiff\r\n//     // Assume id in idList are all unique\r\n//     var idIndicesMap = {};\r\n//     var idx = 0;\r\n//     for (var i = 0; i < newIdList.length; i++) {\r\n//         idIndicesMap[newIdList[i]] = idx;\r\n//         newIdList[i] = idx++;\r\n//     }\r\n//     for (var i = 0; i < oldIdList.length; i++) {\r\n//         var oldId = oldIdList[i];\r\n//         // Same with newIdList\r\n//         if (idIndicesMap[oldId]) {\r\n//             oldIdList[i] = idIndicesMap[oldId];\r\n//         }\r\n//         else {\r\n//             oldIdList[i] = idx++;\r\n//         }\r\n//     }\r\n// }\r\nfunction diffData(oldData, newData) {\r\n  var diffResult = [];\r\n  newData.diff(oldData).add(function (idx) {\r\n    diffResult.push({\r\n      cmd: '+',\r\n      idx: idx\r\n    });\r\n  }).update(function (newIdx, oldIdx) {\r\n    diffResult.push({\r\n      cmd: '=',\r\n      idx: oldIdx,\r\n      idx1: newIdx\r\n    });\r\n  }).remove(function (idx) {\r\n    diffResult.push({\r\n      cmd: '-',\r\n      idx: idx\r\n    });\r\n  }).execute();\r\n  return diffResult;\r\n}\r\n\r\nfunction _default(oldData, newData, oldStackedOnPoints, newStackedOnPoints, oldCoordSys, newCoordSys, oldValueOrigin, newValueOrigin) {\r\n  var diff = diffData(oldData, newData); // var newIdList = newData.mapArray(newData.getId);\r\n  // var oldIdList = oldData.mapArray(oldData.getId);\r\n  // convertToIntId(newIdList, oldIdList);\r\n  // // FIXME One data ?\r\n  // diff = arrayDiff(oldIdList, newIdList);\r\n\r\n  var currPoints = [];\r\n  var nextPoints = []; // Points for stacking base line\r\n\r\n  var currStackedPoints = [];\r\n  var nextStackedPoints = [];\r\n  var status = [];\r\n  var sortedIndices = [];\r\n  var rawIndices = [];\r\n  var newDataOldCoordInfo = prepareDataCoordInfo(oldCoordSys, newData, oldValueOrigin);\r\n  var oldDataNewCoordInfo = prepareDataCoordInfo(newCoordSys, oldData, newValueOrigin);\r\n\r\n  for (var i = 0; i < diff.length; i++) {\r\n    var diffItem = diff[i];\r\n    var pointAdded = true; // FIXME, animation is not so perfect when dataZoom window moves fast\r\n    // Which is in case remvoing or add more than one data in the tail or head\r\n\r\n    switch (diffItem.cmd) {\r\n      case '=':\r\n        var currentPt = oldData.getItemLayout(diffItem.idx);\r\n        var nextPt = newData.getItemLayout(diffItem.idx1); // If previous data is NaN, use next point directly\r\n\r\n        if (isNaN(currentPt[0]) || isNaN(currentPt[1])) {\r\n          currentPt = nextPt.slice();\r\n        }\r\n\r\n        currPoints.push(currentPt);\r\n        nextPoints.push(nextPt);\r\n        currStackedPoints.push(oldStackedOnPoints[diffItem.idx]);\r\n        nextStackedPoints.push(newStackedOnPoints[diffItem.idx1]);\r\n        rawIndices.push(newData.getRawIndex(diffItem.idx1));\r\n        break;\r\n\r\n      case '+':\r\n        var idx = diffItem.idx;\r\n        currPoints.push(oldCoordSys.dataToPoint([newData.get(newDataOldCoordInfo.dataDimsForPoint[0], idx), newData.get(newDataOldCoordInfo.dataDimsForPoint[1], idx)]));\r\n        nextPoints.push(newData.getItemLayout(idx).slice());\r\n        currStackedPoints.push(getStackedOnPoint(newDataOldCoordInfo, oldCoordSys, newData, idx));\r\n        nextStackedPoints.push(newStackedOnPoints[idx]);\r\n        rawIndices.push(newData.getRawIndex(idx));\r\n        break;\r\n\r\n      case '-':\r\n        var idx = diffItem.idx;\r\n        var rawIndex = oldData.getRawIndex(idx); // Data is replaced. In the case of dynamic data queue\r\n        // FIXME FIXME FIXME\r\n\r\n        if (rawIndex !== idx) {\r\n          currPoints.push(oldData.getItemLayout(idx));\r\n          nextPoints.push(newCoordSys.dataToPoint([oldData.get(oldDataNewCoordInfo.dataDimsForPoint[0], idx), oldData.get(oldDataNewCoordInfo.dataDimsForPoint[1], idx)]));\r\n          currStackedPoints.push(oldStackedOnPoints[idx]);\r\n          nextStackedPoints.push(getStackedOnPoint(oldDataNewCoordInfo, newCoordSys, oldData, idx));\r\n          rawIndices.push(rawIndex);\r\n        } else {\r\n          pointAdded = false;\r\n        }\r\n\r\n    } // Original indices\r\n\r\n\r\n    if (pointAdded) {\r\n      status.push(diffItem);\r\n      sortedIndices.push(sortedIndices.length);\r\n    }\r\n  } // Diff result may be crossed if all items are changed\r\n  // Sort by data index\r\n\r\n\r\n  sortedIndices.sort(function (a, b) {\r\n    return rawIndices[a] - rawIndices[b];\r\n  });\r\n  var sortedCurrPoints = [];\r\n  var sortedNextPoints = [];\r\n  var sortedCurrStackedPoints = [];\r\n  var sortedNextStackedPoints = [];\r\n  var sortedStatus = [];\r\n\r\n  for (var i = 0; i < sortedIndices.length; i++) {\r\n    var idx = sortedIndices[i];\r\n    sortedCurrPoints[i] = currPoints[idx];\r\n    sortedNextPoints[i] = nextPoints[idx];\r\n    sortedCurrStackedPoints[i] = currStackedPoints[idx];\r\n    sortedNextStackedPoints[i] = nextStackedPoints[idx];\r\n    sortedStatus[i] = status[idx];\r\n  }\r\n\r\n  return {\r\n    current: sortedCurrPoints,\r\n    next: sortedNextPoints,\r\n    stackedOnCurrent: sortedCurrStackedPoints,\r\n    stackedOnNext: sortedNextStackedPoints,\r\n    status: sortedStatus\r\n  };\r\n}\r\n\r\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}