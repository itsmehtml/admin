{"ast":null,"code":"var util = require(\"./core/util\");\n\nvar _config = require(\"./config\");\n\nvar devicePixelRatio = _config.devicePixelRatio;\n\nvar Style = require(\"./graphic/Style\");\n\nvar Pattern = require(\"./graphic/Pattern\");\n/**\r\n * @module zrender/Layer\r\n * @author pissang(https://www.github.com/pissang)\r\n */\n\n\nfunction returnFalse() {\n  return false;\n}\n/**\r\n * 创建dom\r\n *\r\n * @inner\r\n * @param {string} id dom id 待用\r\n * @param {Painter} painter painter instance\r\n * @param {number} number\r\n */\n\n\nfunction createDom(id, painter, dpr) {\n  var newDom = util.createCanvas();\n  var width = painter.getWidth();\n  var height = painter.getHeight();\n  var newDomStyle = newDom.style;\n\n  if (newDomStyle) {\n    // In node or some other non-browser environment\n    newDomStyle.position = 'absolute';\n    newDomStyle.left = 0;\n    newDomStyle.top = 0;\n    newDomStyle.width = width + 'px';\n    newDomStyle.height = height + 'px';\n    newDom.setAttribute('data-zr-dom-id', id);\n  }\n\n  newDom.width = width * dpr;\n  newDom.height = height * dpr;\n  return newDom;\n}\n/**\r\n * @alias module:zrender/Layer\r\n * @constructor\r\n * @extends module:zrender/mixin/Transformable\r\n * @param {string} id\r\n * @param {module:zrender/Painter} painter\r\n * @param {number} [dpr]\r\n */\n\n\nvar Layer = function Layer(id, painter, dpr) {\n  var dom;\n  dpr = dpr || devicePixelRatio;\n\n  if (typeof id === 'string') {\n    dom = createDom(id, painter, dpr);\n  } // Not using isDom because in node it will return false\n  else if (util.isObject(id)) {\n      dom = id;\n      id = dom.id;\n    }\n\n  this.id = id;\n  this.dom = dom;\n  var domStyle = dom.style;\n\n  if (domStyle) {\n    // Not in node\n    dom.onselectstart = returnFalse; // 避免页面选中的尴尬\n\n    domStyle['-webkit-user-select'] = 'none';\n    domStyle['user-select'] = 'none';\n    domStyle['-webkit-touch-callout'] = 'none';\n    domStyle['-webkit-tap-highlight-color'] = 'rgba(0,0,0,0)';\n    domStyle['padding'] = 0; // eslint-disable-line dot-notation\n\n    domStyle['margin'] = 0; // eslint-disable-line dot-notation\n\n    domStyle['border-width'] = 0;\n  }\n\n  this.domBack = null;\n  this.ctxBack = null;\n  this.painter = painter;\n  this.config = null; // Configs\n\n  /**\r\n   * 每次清空画布的颜色\r\n   * @type {string}\r\n   * @default 0\r\n   */\n\n  this.clearColor = 0;\n  /**\r\n   * 是否开启动态模糊\r\n   * @type {boolean}\r\n   * @default false\r\n   */\n\n  this.motionBlur = false;\n  /**\r\n   * 在开启动态模糊的时候使用，与上一帧混合的alpha值，值越大尾迹越明显\r\n   * @type {number}\r\n   * @default 0.7\r\n   */\n\n  this.lastFrameAlpha = 0.7;\n  /**\r\n   * Layer dpr\r\n   * @type {number}\r\n   */\n\n  this.dpr = dpr;\n};\n\nLayer.prototype = {\n  constructor: Layer,\n  __dirty: true,\n  __used: false,\n  __drawIndex: 0,\n  __startIndex: 0,\n  __endIndex: 0,\n  incremental: false,\n  getElementCount: function getElementCount() {\n    return this.__endIndex - this.__startIndex;\n  },\n  initContext: function initContext() {\n    this.ctx = this.dom.getContext('2d');\n    this.ctx.dpr = this.dpr;\n  },\n  createBackBuffer: function createBackBuffer() {\n    var dpr = this.dpr;\n    this.domBack = createDom('back-' + this.id, this.painter, dpr);\n    this.ctxBack = this.domBack.getContext('2d');\n\n    if (dpr !== 1) {\n      this.ctxBack.scale(dpr, dpr);\n    }\n  },\n\n  /**\r\n   * @param  {number} width\r\n   * @param  {number} height\r\n   */\n  resize: function resize(width, height) {\n    var dpr = this.dpr;\n    var dom = this.dom;\n    var domStyle = dom.style;\n    var domBack = this.domBack;\n\n    if (domStyle) {\n      domStyle.width = width + 'px';\n      domStyle.height = height + 'px';\n    }\n\n    dom.width = width * dpr;\n    dom.height = height * dpr;\n\n    if (domBack) {\n      domBack.width = width * dpr;\n      domBack.height = height * dpr;\n\n      if (dpr !== 1) {\n        this.ctxBack.scale(dpr, dpr);\n      }\n    }\n  },\n\n  /**\r\n   * 清空该层画布\r\n   * @param {boolean} [clearAll]=false Clear all with out motion blur\r\n   * @param {Color} [clearColor]\r\n   */\n  clear: function clear(clearAll, clearColor) {\n    var dom = this.dom;\n    var ctx = this.ctx;\n    var width = dom.width;\n    var height = dom.height;\n    var clearColor = clearColor || this.clearColor;\n    var haveMotionBLur = this.motionBlur && !clearAll;\n    var lastFrameAlpha = this.lastFrameAlpha;\n    var dpr = this.dpr;\n\n    if (haveMotionBLur) {\n      if (!this.domBack) {\n        this.createBackBuffer();\n      }\n\n      this.ctxBack.globalCompositeOperation = 'copy';\n      this.ctxBack.drawImage(dom, 0, 0, width / dpr, height / dpr);\n    }\n\n    ctx.clearRect(0, 0, width, height);\n\n    if (clearColor && clearColor !== 'transparent') {\n      var clearColorGradientOrPattern; // Gradient\n\n      if (clearColor.colorStops) {\n        // Cache canvas gradient\n        clearColorGradientOrPattern = clearColor.__canvasGradient || Style.getGradient(ctx, clearColor, {\n          x: 0,\n          y: 0,\n          width: width,\n          height: height\n        });\n        clearColor.__canvasGradient = clearColorGradientOrPattern;\n      } // Pattern\n      else if (clearColor.image) {\n          clearColorGradientOrPattern = Pattern.prototype.getCanvasPattern.call(clearColor, ctx);\n        }\n\n      ctx.save();\n      ctx.fillStyle = clearColorGradientOrPattern || clearColor;\n      ctx.fillRect(0, 0, width, height);\n      ctx.restore();\n    }\n\n    if (haveMotionBLur) {\n      var domBack = this.domBack;\n      ctx.save();\n      ctx.globalAlpha = lastFrameAlpha;\n      ctx.drawImage(domBack, 0, 0, width, height);\n      ctx.restore();\n    }\n  }\n};\nvar _default = Layer;\nmodule.exports = _default;","map":{"version":3,"sources":["C:/Users/user/Desktop/Admin/node_modules/zrender/lib/Layer.js"],"names":["util","require","_config","devicePixelRatio","Style","Pattern","returnFalse","createDom","id","painter","dpr","newDom","createCanvas","width","getWidth","height","getHeight","newDomStyle","style","position","left","top","setAttribute","Layer","dom","isObject","domStyle","onselectstart","domBack","ctxBack","config","clearColor","motionBlur","lastFrameAlpha","prototype","constructor","__dirty","__used","__drawIndex","__startIndex","__endIndex","incremental","getElementCount","initContext","ctx","getContext","createBackBuffer","scale","resize","clear","clearAll","haveMotionBLur","globalCompositeOperation","drawImage","clearRect","clearColorGradientOrPattern","colorStops","__canvasGradient","getGradient","x","y","image","getCanvasPattern","call","save","fillStyle","fillRect","restore","globalAlpha","_default","module","exports"],"mappings":"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","sourcesContent":["var util = require(\"./core/util\");\r\n\r\nvar _config = require(\"./config\");\r\n\r\nvar devicePixelRatio = _config.devicePixelRatio;\r\n\r\nvar Style = require(\"./graphic/Style\");\r\n\r\nvar Pattern = require(\"./graphic/Pattern\");\r\n\r\n/**\r\n * @module zrender/Layer\r\n * @author pissang(https://www.github.com/pissang)\r\n */\r\nfunction returnFalse() {\r\n  return false;\r\n}\r\n/**\r\n * 创建dom\r\n *\r\n * @inner\r\n * @param {string} id dom id 待用\r\n * @param {Painter} painter painter instance\r\n * @param {number} number\r\n */\r\n\r\n\r\nfunction createDom(id, painter, dpr) {\r\n  var newDom = util.createCanvas();\r\n  var width = painter.getWidth();\r\n  var height = painter.getHeight();\r\n  var newDomStyle = newDom.style;\r\n\r\n  if (newDomStyle) {\r\n    // In node or some other non-browser environment\r\n    newDomStyle.position = 'absolute';\r\n    newDomStyle.left = 0;\r\n    newDomStyle.top = 0;\r\n    newDomStyle.width = width + 'px';\r\n    newDomStyle.height = height + 'px';\r\n    newDom.setAttribute('data-zr-dom-id', id);\r\n  }\r\n\r\n  newDom.width = width * dpr;\r\n  newDom.height = height * dpr;\r\n  return newDom;\r\n}\r\n/**\r\n * @alias module:zrender/Layer\r\n * @constructor\r\n * @extends module:zrender/mixin/Transformable\r\n * @param {string} id\r\n * @param {module:zrender/Painter} painter\r\n * @param {number} [dpr]\r\n */\r\n\r\n\r\nvar Layer = function (id, painter, dpr) {\r\n  var dom;\r\n  dpr = dpr || devicePixelRatio;\r\n\r\n  if (typeof id === 'string') {\r\n    dom = createDom(id, painter, dpr);\r\n  } // Not using isDom because in node it will return false\r\n  else if (util.isObject(id)) {\r\n      dom = id;\r\n      id = dom.id;\r\n    }\r\n\r\n  this.id = id;\r\n  this.dom = dom;\r\n  var domStyle = dom.style;\r\n\r\n  if (domStyle) {\r\n    // Not in node\r\n    dom.onselectstart = returnFalse; // 避免页面选中的尴尬\r\n\r\n    domStyle['-webkit-user-select'] = 'none';\r\n    domStyle['user-select'] = 'none';\r\n    domStyle['-webkit-touch-callout'] = 'none';\r\n    domStyle['-webkit-tap-highlight-color'] = 'rgba(0,0,0,0)';\r\n    domStyle['padding'] = 0; // eslint-disable-line dot-notation\r\n\r\n    domStyle['margin'] = 0; // eslint-disable-line dot-notation\r\n\r\n    domStyle['border-width'] = 0;\r\n  }\r\n\r\n  this.domBack = null;\r\n  this.ctxBack = null;\r\n  this.painter = painter;\r\n  this.config = null; // Configs\r\n\r\n  /**\r\n   * 每次清空画布的颜色\r\n   * @type {string}\r\n   * @default 0\r\n   */\r\n\r\n  this.clearColor = 0;\r\n  /**\r\n   * 是否开启动态模糊\r\n   * @type {boolean}\r\n   * @default false\r\n   */\r\n\r\n  this.motionBlur = false;\r\n  /**\r\n   * 在开启动态模糊的时候使用，与上一帧混合的alpha值，值越大尾迹越明显\r\n   * @type {number}\r\n   * @default 0.7\r\n   */\r\n\r\n  this.lastFrameAlpha = 0.7;\r\n  /**\r\n   * Layer dpr\r\n   * @type {number}\r\n   */\r\n\r\n  this.dpr = dpr;\r\n};\r\n\r\nLayer.prototype = {\r\n  constructor: Layer,\r\n  __dirty: true,\r\n  __used: false,\r\n  __drawIndex: 0,\r\n  __startIndex: 0,\r\n  __endIndex: 0,\r\n  incremental: false,\r\n  getElementCount: function () {\r\n    return this.__endIndex - this.__startIndex;\r\n  },\r\n  initContext: function () {\r\n    this.ctx = this.dom.getContext('2d');\r\n    this.ctx.dpr = this.dpr;\r\n  },\r\n  createBackBuffer: function () {\r\n    var dpr = this.dpr;\r\n    this.domBack = createDom('back-' + this.id, this.painter, dpr);\r\n    this.ctxBack = this.domBack.getContext('2d');\r\n\r\n    if (dpr !== 1) {\r\n      this.ctxBack.scale(dpr, dpr);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @param  {number} width\r\n   * @param  {number} height\r\n   */\r\n  resize: function (width, height) {\r\n    var dpr = this.dpr;\r\n    var dom = this.dom;\r\n    var domStyle = dom.style;\r\n    var domBack = this.domBack;\r\n\r\n    if (domStyle) {\r\n      domStyle.width = width + 'px';\r\n      domStyle.height = height + 'px';\r\n    }\r\n\r\n    dom.width = width * dpr;\r\n    dom.height = height * dpr;\r\n\r\n    if (domBack) {\r\n      domBack.width = width * dpr;\r\n      domBack.height = height * dpr;\r\n\r\n      if (dpr !== 1) {\r\n        this.ctxBack.scale(dpr, dpr);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * 清空该层画布\r\n   * @param {boolean} [clearAll]=false Clear all with out motion blur\r\n   * @param {Color} [clearColor]\r\n   */\r\n  clear: function (clearAll, clearColor) {\r\n    var dom = this.dom;\r\n    var ctx = this.ctx;\r\n    var width = dom.width;\r\n    var height = dom.height;\r\n    var clearColor = clearColor || this.clearColor;\r\n    var haveMotionBLur = this.motionBlur && !clearAll;\r\n    var lastFrameAlpha = this.lastFrameAlpha;\r\n    var dpr = this.dpr;\r\n\r\n    if (haveMotionBLur) {\r\n      if (!this.domBack) {\r\n        this.createBackBuffer();\r\n      }\r\n\r\n      this.ctxBack.globalCompositeOperation = 'copy';\r\n      this.ctxBack.drawImage(dom, 0, 0, width / dpr, height / dpr);\r\n    }\r\n\r\n    ctx.clearRect(0, 0, width, height);\r\n\r\n    if (clearColor && clearColor !== 'transparent') {\r\n      var clearColorGradientOrPattern; // Gradient\r\n\r\n      if (clearColor.colorStops) {\r\n        // Cache canvas gradient\r\n        clearColorGradientOrPattern = clearColor.__canvasGradient || Style.getGradient(ctx, clearColor, {\r\n          x: 0,\r\n          y: 0,\r\n          width: width,\r\n          height: height\r\n        });\r\n        clearColor.__canvasGradient = clearColorGradientOrPattern;\r\n      } // Pattern\r\n      else if (clearColor.image) {\r\n          clearColorGradientOrPattern = Pattern.prototype.getCanvasPattern.call(clearColor, ctx);\r\n        }\r\n\r\n      ctx.save();\r\n      ctx.fillStyle = clearColorGradientOrPattern || clearColor;\r\n      ctx.fillRect(0, 0, width, height);\r\n      ctx.restore();\r\n    }\r\n\r\n    if (haveMotionBLur) {\r\n      var domBack = this.domBack;\r\n      ctx.save();\r\n      ctx.globalAlpha = lastFrameAlpha;\r\n      ctx.drawImage(domBack, 0, 0, width, height);\r\n      ctx.restore();\r\n    }\r\n  }\r\n};\r\nvar _default = Layer;\r\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}